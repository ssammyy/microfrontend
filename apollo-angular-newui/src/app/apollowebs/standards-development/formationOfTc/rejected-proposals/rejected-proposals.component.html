<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-primary card-header-icon">
                <div class="card-icon">
                    <i class="material-icons">assignment</i>
                </div>
                <h4 class="card-title">Declined Proposals
                </h4>
            </div>
            <div class="card-body">
                <div class="material-datatables">
                    <table class="table table-striped table-bordered table-hover" datatable
                           [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                        <thead>
                        <tr>
                            <th>Reference Number</th>
                            <th>Purpose</th>
                            <th>TC Name</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let secTask of tasks let i= index; ">
                            <td>{{secTask.referenceNumber}}</td>
                            <td>{{secTask.purpose}}</td>
                            <td>{{secTask.nameOfTC}}</td>
                            <td>
                               <span style=" font-size: 10px;"
                                     class="badge badge-danger">Declined</span>
                            </td>
                            <td>
                                <a (click)="openModalToView(secTask)"
                                   class="btn btn-info tooltips"
                                   data-placement="top"
                                   data-original-title="Review"> View More</a>
                            </td>

                        </tr>
                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="editModal" tabindex="-1" role="dialog"
     aria-labelledby="updateExampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editExampleModalLabel">Proposal for formation of TC</h5>
                <button type="button" class="close" #closeModalB data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <form #formDirectiveB="ngForm" (ngSubmit)="editProposalForTC(formDirectiveB)"
                      [formGroup]="editFormationRequestFormGroup">
                    <div class="form-body">
                        <div class="row">

                            <div class="form-group col-12">

                                <label><b>Date of Application</b></label>
                                <input
                                        aria-describedby="inputGroup-sizing-sm"
                                        aria-label="Small"
                                        class="form-control one-column-input" readonly
                                        formControlName="dateOfPresentation"
                                        ngModel="{{this.proposalRetrieved?.dateOfPresentation}}"
                                        type="text">
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Proposer</b></label>
                                <input
                                        aria-describedby="inputGroup-sizing-sm"
                                        aria-label="Small"
                                        class="form-control one-column-input" readonly
                                        formControlName="userDetails"
                                        ngModel="{{userDetails?.firstName + ' ' + userDetails?.lastName}}"
                                        type="text">
                            </div>

                        </div>
                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Reference number</b></label>
                                <input aria-describedby="inputGroup-sizing-sm"
                                       aria-label="Small"
                                       class="form-control one-column-input" readonly
                                       formControlName="referenceNumber"
                                       ngModel="{{this.proposalRetrieved?.referenceNumber}}">
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group col-12">

                                <label><b>Name of TC</b></label>
                                <mat-form-field class="example-full-width has-label"
                                                [ngClass]="displayFieldCss(editFormationRequestFormGroup, 'nameOfTC')">
                                    <input type="text"
                                           matInput
                                           placeholder="Name Of Technical Committee *"
                                           (ngModelChange)="textValidationType($event)"
                                           ngModel="{{this.proposalRetrieved?.nameOfTC}}"

                                           formControlName="nameOfTC">
                                    <app-field-error-display
                                            [displayError]="isFieldValid(editFormationRequestFormGroup, 'nameOfTC')"
                                            errorMsg="Please Enter Name Of Technical Committee">
                                    </app-field-error-display>
                                </mat-form-field>
                            </div>

                        </div>


                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Scope</b></label>
                                <mat-form-field class="example-full-width has-label"
                                                [ngClass]="displayFieldCss(editFormationRequestFormGroup, 'scope')">
                                    <input type="text"
                                           matInput
                                           placeholder="Scope *"
                                           (ngModelChange)="textValidationType($event)"
                                           ngModel="{{this.proposalRetrieved?.scope}}"

                                           formControlName="scope">
                                    <app-field-error-display
                                            [displayError]="isFieldValid(editFormationRequestFormGroup, 'scope')"
                                            errorMsg="Please Enter Scope">
                                    </app-field-error-display>
                                </mat-form-field>
                            </div>
                        </div>


                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Purpose and Justification</b></label>
                                <mat-form-field class="example-full-width has-label"
                                                [ngClass]="displayFieldCss(editFormationRequestFormGroup, 'purpose')">
                                    <textarea
                                            matInput
                                            aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                            class="form-control one-column-input" formControlName="purpose"
                                            ngModel="{{this.proposalRetrieved?.purpose}}"

                                            placeholder="Purpose and Justification *" type="text"></textarea>
                                    <app-field-error-display
                                            [displayError]="isFieldValid(editFormationRequestFormGroup, 'purpose')"
                                            errorMsg="Please Enter Purpose">
                                    </app-field-error-display>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Proposed TC Representation</b></label>

                                <mat-form-field class="example-full-width has-label"
                                                [ngClass]="displayFieldCss(editFormationRequestFormGroup, 'proposedRepresentation')">
                                        <textarea
                                                matInput
                                                ngModel="{{this.proposalRetrieved?.proposedRepresentation}}"
                                                aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                class="form-control one-column-input"
                                                formControlName="proposedRepresentation"
                                                readonly type="text">
                                        </textarea>
                                    <app-field-error-display
                                            [displayError]="isFieldValid(editFormationRequestFormGroup, 'proposedRepresentation')"
                                            errorMsg="Please Enter Proposed TC Representation">
                                    </app-field-error-display>
                                </mat-form-field>

                                <div *ngIf="roles?.includes('TC_SEC_SD_READ')">
                                    <button *ngIf="!showEditForm" (click)="showForm()">Edit</button>
                                    <button *ngIf="showEditForm" (click)="hideForm()">Do Not Edit</button>
                                </div>

                            </div>

                        </div>

                        <div *ngIf="showEditForm">

                            <div class="row">
                                <div class="form-group col-12">
                                    <label><b>Proposed TC Representation</b></label>
                                    <mat-form-field>
                                        <mat-label>Select at least three Tc Representations</mat-label>
                                        <mat-select id="options" aria-label="Small"
                                                    aria-describedby="inputGroup-sizing-lg"
                                                    class="form-control" required
                                                    formControlName="proposedRepresentationArray" multiple>
                                            <mat-option *ngFor="let option of options"
                                                        [value]="option.value">{{ option.label }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    <div *ngIf="editFormationRequestFormGroup.get('proposedRepresentationArray').invalid && (editFormationRequestFormGroup.get('proposedRepresentationArray').dirty || editFormationRequestFormGroup.get('proposedRepresentationArray').touched)">
                                        <div *ngIf="editFormationRequestFormGroup.get('proposedRepresentationArray').errors.required">
                                            Please select at least one option.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-12">

                                    <div id="form-fields">
                                        <ng-container *ngFor="let field of formFields">
                                            <label for="{{field.id}}"><b>{{field.label}}</b><small> (Add
                                                multiple by
                                                separating with comma.)</small></label>
                                            <mat-form-field class="example-full-width has-label">
                                        <textarea
                                                matInput
                                                id="{{field.id}}"
                                                aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                class="form-control one-column-input" required
                                                name="{{field.id}}" [formControl]="field.control"
                                                type="text"></textarea>
                                            </mat-form-field>
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>Department</b></label>
                                <mat-form-field>
                                    <mat-select aria-label="Small"
                                                aria-describedby="inputGroup-sizing-lg"
                                                class="form-control" required
                                                formControlName="departmentId"
                                                name="departmentId"
                                                placeholder="{{selectedDepartment}}">
                                        <mat-option *ngFor="let department of departments"
                                                    [value]="department.id +'$'+department.name">
                                            {{department.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group col-12">
                                <label><b>SO/IEE/IEC Mirror Committee</b></label>
                                <mat-form-field class="example-full-width has-label"
                                                [ngClass]="displayFieldCss(editFormationRequestFormGroup, 'isoCommittee')">
                                    <input
                                            matInput
                                            ngModel="{{this.proposalRetrieved?.isoCommittee}}"
                                            aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                            class="form-control one-column-input"
                                            formControlName="isoCommittee"
                                            placeholder="SO/IEE/IEC Mirror Committee" type="text">

                                </mat-form-field>
                            </div>

                        </div>
                        <input hidden formControlName="id" [ngModel]="this.proposalRetrieved?.id"
                               name="id">

                        <input hidden formControlName="departmentIdOriginal"
                               [ngModel]="this.proposalRetrieved?.departmentId"
                               name="departmentIdOriginal">


                        <ng-container [ngSwitch]="this.proposalRetrieved?.status">
                            <ng-container *ngSwitchCase="'3'">
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li style="background-color: red"
                                                class="list-group-item active">HOF
                                                DECLINATION
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION
                                                BY:{{hofDetails?.firstName + ' ' + hofDetails?.lastName}}</li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION REASON:
                                                {{this.proposalRetrieved?.comments}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION
                                                DATE:{{formatFormDate(this.proposalRetrieved?.hofReviewDate)}}</li>

                                        </ul>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngSwitchCase="'5'">
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li class="list-group-item active">HOF APPROVAL
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL
                                                BY:{{hofDetails?.firstName + ' ' + hofDetails?.lastName}}</li>
                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL REASON:
                                                {{this.proposalRetrieved?.comments}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL
                                                DATE:{{formatFormDate(this.proposalRetrieved?.hofReviewDate)}}</li>

                                        </ul>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li style="background-color: red"
                                                class="list-group-item active">SPC
                                                DECLINATION
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION BY:
                                                {{spcDetails?.firstName + ' ' + spcDetails?.lastName}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION REASON:
                                                {{this.proposalRetrieved?.commentsSpc}}
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION DATE:
                                                {{formatFormDate(this.proposalRetrieved?.spcReviewDate)}}
                                            </li>

                                        </ul>
                                    </div>
                                </div>

                            </ng-container>
                            <ng-container *ngSwitchCase="'7'">
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li class="list-group-item active">HOF APPROVAL
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL
                                                BY:{{hofDetails?.firstName + ' ' + hofDetails?.lastName}}</li>
                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL REASON:
                                                {{this.proposalRetrieved?.comments}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL
                                                DATE:{{formatFormDate(this.proposalRetrieved?.hofReviewDate)}}</li>

                                        </ul>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li class="list-group-item active">SPC APPROVAL
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL BY:
                                                {{spcDetails?.firstName + ' ' + spcDetails?.lastName}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL REASON:
                                                {{this.proposalRetrieved?.commentsSpc}}
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">APPROVAL DATE:
                                                {{formatFormDate(this.proposalRetrieved?.spcReviewDate)}}
                                            </li>

                                        </ul>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li style="background-color: red"
                                                class="list-group-item active">SAC
                                                DECLINATION
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION BY:
                                                {{sacDetails?.firstName + ' ' + sacDetails?.lastName}}
                                            </li>
                                            <li style="background: lightgray"
                                                class="list-group-item">RECOMMENDATION:
                                                {{this.proposalRetrieved?.commentsSac}}
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">DECLINATION DATE:
                                                {{formatFormDate(this.proposalRetrieved?.sacReviewDate)}}
                                            </li>

                                        </ul>
                                    </div>
                                </div>

                            </ng-container>


                            <ng-container *ngSwitchDefault></ng-container>
                        </ng-container>

                        <ng-container [ngSwitch]="this.proposalRetrieved?.status">
                            <ng-container *ngSwitchCase="'1'">

                                <div *ngIf="roles?.includes('TC_SEC_SD_READ') || roles?.includes( 'STANDARDS_DEVELOPMENT_FULL_ADMIN')">
                                    <button class="btn btn-info" type="submit">
                                        Edit
                                    </button>
                                </div>
                            </ng-container>
                            <ng-container *ngSwitchDefault>
                                <div *ngIf="roles?.includes('TC_SEC_SD_READ') || roles?.includes( 'STANDARDS_DEVELOPMENT_FULL_ADMIN')">

                                    <button class="btn btn-info" type="submit">
                                        Resubmit
                                    </button>
                                </div>
                            </ng-container>
                        </ng-container>


                        <button data-dismiss="modal" style="float: right" class="btn btn-danger">
                            Close
                        </button>


                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

