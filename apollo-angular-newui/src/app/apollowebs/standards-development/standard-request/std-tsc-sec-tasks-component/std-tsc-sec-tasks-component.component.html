<div class="container-fluid" style="margin-top: 5%" id="main-container">
    <div class="loading-spinner ">
        <ngx-spinner
                bdColor="rgba(51,51,51,0.8)"
                size="medium"
                color="#fff"
                type="ball-scale-multiple"
        >
            <p style="font-size: 20px; color: white">Loading...</p>
        </ngx-spinner>
    </div>
    <div class="main-content">
        <div class="container-fluid">

            <mat-tab-group class="example-stretched-tabs mat-elevation-z4" mat-align-tabs="center">
                <mat-tab label="Prepare NWI">
                    <ng-template mat-tab-label>
                        <span matBadge="{{secTasks.length}}" matBadgeOverlap="false">Prepare NWI</span>
                    </ng-template>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header card-header-primary card-header-icon">
                                    <div class="card-icon">
                                        <i class="material-icons">assignment</i>
                                    </div>
                                    <h4 class="card-title">Tasks <small class="resolved-pill">{{secTasks.length}}
                                        Tasks</small>
                                    </h4>

                                </div>
                                <div class="card-body">
                                    <div class="toolbar">

                                    </div>


                                    <div class="material-datatables">
                                        <table class="table table-striped table-bordered table-hover" datatable
                                               [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                                            <thead>
                                            <tr>
                                                <th class="task">Request No.</th>
                                                <th class="task">Section</th>
                                                <th class="task">Subject</th>
                                                <th class="task">Requester</th>
                                                <th class="action">Action</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr *ngFor="let secTask of secTasks let i= index; ">

                                                <td>{{secTask.requestNumber}}</td>
                                                <td>{{secTask.departmentName}}</td>
                                                <td>{{secTask.subject}}</td>
                                                <td>{{secTask.name}}</td>

                                                <td><a (click)="onOpenModal(secTask,'edit')"
                                                       class="btn btn-info tooltips"
                                                       data-placement="top"
                                                       data-original-title="Upload NWI">Upload Item</a></td>

                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>
                </mat-tab>
                <mat-tab label="Votes On NWIs"> NWI Votes</mat-tab>
                <mat-tab label="Approved NWIs"> Approved Items</mat-tab>
                <mat-tab label="Rejected NWIs"> Rejected Items</mat-tab>

            </mat-tab-group>
            <div class="modal fade " id="updateNWIModal" tabindex="-1" role="dialog"
                 aria-labelledby="updateExampleModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog modal-lg modal-xl" role="document" style="width: 100%">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="updateExampleModalLabel">Proposal for
                                New Work
                                Item</h5>
                            <button type="button" class="close" data-dismiss="modal"
                                    aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <form #editForm="ngForm" (ngSubmit)="saveNwi(editForm)" [formGroup]="stdNwiFormGroup">
                            <div class="modal-body">
                                <div class="row">
                                    <div class="form-group col-6">
                                        <!--                                        <label><b>Enter Proposal title</b></label>-->
                                        <!--                                        <input-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                ngModel="{{tscsecRequest?.proposalTitle}}"-->
                                        <!--                                                value=""-->
                                        <!--                                                name="proposalTitle"-->
                                        <!--                                                placeholder="Indicate subject matter of the proposed new standard"-->
                                        <!--                                                type="text">-->

                                        <label><b>Enter Proposal title:</b></label>
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'proposalTitle')">
                                            <input type="text"
                                                   matInput
                                                   id="proposalTitle"
                                                   placeholder="Indicate subject matter of the proposed new standard"
                                                   (ngModelChange)="textValidationType($event)"
                                                   formControlName="proposalTitle">
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'proposalTitle')"
                                                    errorMsg="Please Enter Proposal Title">
                                            </app-field-error-display>
                                        </mat-form-field>


                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Scope</b></label>
                                        <!--                                        <textarea-->
                                        <!--                                                ngModel="{{tscsecRequest?.scope}}"-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                name="scope"-->
                                        <!--                                                placeholder="Give a clear indication of the coverage of the proposed new standard"-->
                                        <!--                                                type="text"></textarea>-->

                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'scope')">
                                            <textarea type="text"
                                                      matInput
                                                      id="scope"
                                                      placeholder="Give a clear indication of the coverage of the proposed new standard"
                                                      (ngModelChange)="textValidationType($event)"
                                                      formControlName="scope"></textarea>
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'scope')"
                                                    errorMsg="Please Enter Scope">
                                            </app-field-error-display>
                                        </mat-form-field>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="form-group col-12">

                                        <label><b>Purpose & application</b><span
                                                data-toggle="tooltip"
                                                data-placement="right"
                                                class="badge badge-success"
                                                title="The justification information should be based on the following, inter alia:
(i) Importance of economic field
(ii) Degree of economic benefit
(iii) Importance as export item
(iv) Capacity as import substitute
(v) Level of consumer protection
(vi) Availability of reference material indicating whether the proposal is for adoption or adaption of the reference material
(vii) Availability of testing facilities
(viii) Volume of production or operation
(x) Ease of adoption and implementation
(xi) Transfer of technology">i</span></label>
                                        <!--                                        <textarea-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                data-toggle="tooltip" data-placement="right"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                name="purpose"-->
                                        <!--                                                ngModel="{{tscsecRequest?.purpose}}"-->
                                        <!--                                                placeholder="Give specific aims and reasons for the standard and main interests to benefit from the standard. Mention any relevant problems in the industry or technology."-->
                                        <!--                                                type="text"></textarea>-->
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'purpose')">
                                            <textarea type="text"
                                                      matInput
                                                      id="purpose"
                                                      placeholder="Give specific aims and reasons for the standard and main interests to benefit from the standard. Mention any relevant problems in the industry or technology."
                                                      (ngModelChange)="textValidationType($event)"
                                                      formControlName="purpose"></textarea>
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'purpose')"
                                                    errorMsg="Please Enter Purpose">
                                            </app-field-error-display>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="row">

                                    <!--                            <div class="form-group col-6">-->
                                    <!--                                <label><b>Upload annex for Purpose & application(optional)</b></label>-->
                                    <!--                                <app-upload-files [itemId]="itemId"  [type]="filePurposeAnnex" ></app-upload-files>-->
                                    <!--                            </div>-->

                                    <div class="row col-12">
                                        <div class="form-group col-12">
                                            <label><b>Upload annex for Purpose &
                                                application(optional)</b></label>
                                            <form #demoForm="ngForm">
                                                <file-upload [(ngModel)]="uploadedFiles"
                                                             name="uploadedFiles" fileslimit="2"
                                                             accept=".pdf, .doc, .docx"></file-upload>
                                                <input class="form-control one-column-input"
                                                       ngModel="TSCSEC Annex Upload"
                                                       name="DocDescription" type="hidden">
                                            </form>
                                        </div>
                                    </div>


                                </div>

                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Target Date</b></label>
                                        <!--                                        <input-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                ngModel="{{tscsecRequest?.targetDate}}"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                name="targetDate"-->
                                        <!--                                                type="date">-->

                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'targetDate')">
                                            <input type="date"
                                                   matInput
                                                   id="targetDate"
                                                   placeholder="Target Date"
                                                   formControlName="targetDate">
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'targetDate')"
                                                    errorMsg="Please Enter Target Date">
                                            </app-field-error-display>
                                        </mat-form-field>


                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Similar Standards/Subject of
                                            Standardization</b></label>
                                        <!--                                        <textarea-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                ngModel="{{tscsecRequest?.similarStandards}}"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                name="similarStandards"-->
                                        <!--                                                placeholder=" " type="text"></textarea>-->
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'similarStandards')">
                                            <textarea type="text"
                                                      matInput
                                                      id="similarStandards"
                                                      placeholder="Similar Standards"
                                                      (ngModelChange)="numberValidationType($event)"
                                                      formControlName="similarStandards"></textarea>
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'similarStandards')"
                                                    errorMsg="Please Enter Similar Standards">
                                            </app-field-error-display>
                                        </mat-form-field>

                                    </div>
                                </div>
                                <div class="row">
                                    <!--                            <div class="form-group col-6">-->
                                    <!--                                <label><b>Relevant Documents</b></label>-->
                                    <!--                                <app-upload-files  [itemId]="itemId" [type]="relevantDocumentsNWI" ></app-upload-files>-->

                                    <!--                            </div>-->

                                    <div class="row col-12">
                                        <div class="form-group col-12">
                                            <label><b>Upload All Relevant Documents</b></label>
                                            <form #demoForm="ngForm">
                                                <file-upload [(ngModel)]="uploadedFilesB"
                                                             name="uploadedFilesB"
                                                             accept=".pdf, .doc, .docx"></file-upload>
                                                <input class="form-control one-column-input"
                                                       ngModel="RelevantDocumentsNWI Upload"
                                                       name="DocDescription" type="hidden">
                                            </form>
                                        </div>
                                    </div>

                                    <div class="form-group col-6">
                                        <label><b>Liaison Organization/or interested parties</b></label>

                                        <ng-multiselect-dropdown
                                                [placeholder]="'Select Liaison Organization'"
                                                [settings]="dropdownSettings"
                                                [data]="dropdownList"
                                                (onSelect)="onItemSelect($event)"
                                                (onSelectAll)="onSelectAll($event)"
                                                [class.is-invalid]="formStdRequest?.liaisonOrganisationData?.errors?.required && formStdRequest?.liaisonOrganisationData?.touched"
                                                formControlName="liaisonOrganisationData"
                                                name="liaisonOrganisationData">
                                        </ng-multiselect-dropdown>
                                        <span *ngIf="formStdRequest?.liaisonOrganisationData?.errors?.required && formStdRequest?.liaisonOrganisationData?.touched"
                                              style="color: red;">Liaison Organization is required </span>

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="row col-12">
                                        <div class="form-group col-12">
                                            <label><b>Upload Any Reference Documents(Optional)</b></label>
                                            <form #demoForm="ngForm">
                                                <file-upload [(ngModel)]="uploadedFilesC"
                                                             name="uploadedFilesC"
                                                             accept=".pdf, .doc, .docx"></file-upload>
                                                <input class="form-control one-column-input"
                                                       ngModel="ReferenceDocumentsNWI Upload"
                                                       name="DocDescription" type="hidden">
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <h5><b>Preparatory Work</b></h5>
                                <div class="row">
                                    <div class="form-check col-6">
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="one-column-input"
                                                formControlName="draftAttached" value="0"
                                                id="defaultCheck1" type="checkbox">
                                        <label class="form-check-label" for="defaultCheck1">
                                            A draft is attached
                                        </label>

                                    </div>
                                    <div class="form-check col-6">
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class=" one-column-input"
                                                formControlName="outlineAttached"
                                                id="defaultCheck2" type="checkbox">
                                        <label class="form-check-label" for="defaultCheck2">
                                            An outline is attached
                                        </label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-check col-6">
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="one-column-input"
                                                formControlName="draftOutlineImpossible"
                                                id="defaultCheck3" type="checkbox">
                                        <label class="form-check-label" for="defaultCheck3">
                                            It is not possible to attach either a draft or
                                            outline
                                        </label>
                                    </div>
                                    <div class="form-check col-6">
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class=" one-column-input"
                                                formControlName="outlineSentLater"
                                                id="defaultCheck4" type="checkbox">
                                        <label class="form-check-label" for="defaultCheck4">
                                            An outline will be sent later
                                        </label>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Enter Name of proposer</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input" readonly
                                                ngModel="{{nwiRequest?.name}}"
                                                value="{{nwiRequest?.name}}"
                                                name="nameOfProposer"
                                                formControlName="nameOfProposer"
                                                type="text">
                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Organization</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                readonly
                                                ngModel="{{nwiRequest?.organisationName}}"
                                                value="{{nwiRequest?.organisationName}}"
                                                formControlName="organization"
                                                name="organization"
                                                type="text">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Date of Circulation</b></label>
                                        <!--                                        <input-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                ngModel="{{tscsecRequest?.circulationDate}}"-->
                                        <!--                                                name="circulationDate"-->
                                        <!--                                                type="date">-->
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'circulationDate')">
                                            <input type="date"
                                                   matInput
                                                   id="circulationDate"
                                                   placeholder="Circulation Date"
                                                   formControlName="circulationDate">
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'circulationDate')"
                                                    errorMsg="Please Enter Circulation Date">
                                            </app-field-error-display>
                                        </mat-form-field>
                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Closing Date</b></label>
                                        <!--                                        <input-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                ngModel="{{tscsecRequest?.closingDate}}"-->
                                        <!--                                                name="closingDate"-->
                                        <!--                                                type="date">-->
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'closingDate')">
                                            <input type="date"
                                                   matInput
                                                   id="closingDate"
                                                   placeholder="Closing Date"
                                                   formControlName="closingDate">
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'closingDate')"
                                                    errorMsg="Please Enter Closing Date">
                                            </app-field-error-display>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Date of presentation</b></label>
                                        <!--                                        <input-->
                                        <!--                                                aria-describedby="inputGroup-sizing-sm"-->
                                        <!--                                                aria-label="Small"-->
                                        <!--                                                class="form-control one-column-input"-->
                                        <!--                                                ngModel="{{tscsecRequest?.dateOfPresentation}}"-->
                                        <!--                                                name="dateOfPresentation"-->
                                        <!--                                                type="date">-->
                                        <mat-form-field class="example-full-width has-label"
                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'dateOfPresentation')">
                                            <input type="date"
                                                   matInput
                                                   id="dateOfPresentation"
                                                   placeholder="Presentation Date"
                                                   formControlName="dateOfPresentation">
                                            <app-field-error-display
                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'dateOfPresentation')"
                                                    errorMsg="Please Enter Presentation Date">
                                            </app-field-error-display>
                                        </mat-form-field>
                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Name of TC</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                formControlName="nameOfTC"
                                                class="form-control one-column-input" readonly
                                                ngModel="{{nwiRequest?.departmentName}}"
                                                value="{{nwiRequest?.departmentName}}"
                                                placeholder="" name="nameOfTC"
                                                type="text">
                                    </div>
                                </div>

                                <div class="row">

                                    <div class="form-group col-6">
                                        <label><b>Reference Number given by
                                            Secretariat</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input" readonly
                                                ngModel="{{nwiRequest?.requestNumber}}"
                                                value="{{nwiRequest?.requestNumber}}"

                                                formControlName="referenceNumber"
                                                placeholder="" name="referenceNumber"
                                                type="text">

                                    </div>
                                </div>

                                <div class="form-group">
                                    <input
                                            aria-describedby="inputGroup-sizing-sm"
                                            aria-label="Small"
                                            class="form-control one-column-input" hidden
                                            type="text"
                                            ngModel="{{nwiRequest?.id}}"
                                            formControlName="standardId" value="{{nwiRequest?.id}}">
                                </div>
                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" #closeModal
                                        (click)="hideModel()" data-dismiss="modal">Close
                                </button>
                                <!--                                <button class="btn btn-info" (click)="onUpload(editForm.value)">-->
                                <!--                                    Submit-->
                                <!--                                </button>-->
                                <button class="btn btn-inf" type="submit">SUBMIT</button>

                            </div>
                        </form>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>
