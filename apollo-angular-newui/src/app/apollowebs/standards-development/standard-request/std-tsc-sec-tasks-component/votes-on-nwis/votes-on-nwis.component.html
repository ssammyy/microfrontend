
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-primary card-header-icon">
                <div class="card-icon">
                    <i class="material-icons">assignment</i>
                </div>
                <h4 class="card-title">Tasks <small class="resolved-pill">{{secTasks.length}}
                    Tasks</small>
                </h4>

            </div>
            <div class="card-body">
                <div class="toolbar">

                </div>


                <div class="material-datatables">
                    <table class="table table-striped table-bordered table-hover" datatable
                           [dtOptions]="dtOptions" [dtTrigger]="dtTrigger2">
                        <thead>
                        <tr>
                            <th class="task">Proposal Title</th>
                            <th class="task">Total Votes</th>

                            <th class="task">Approved</th>
                            <th class="task">Not Approved</th>
                            <th class="action">Status</th>
                            <th class="action">Votes</th>

                            <th class="action">Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let secTask of nwiForVotes let i= index; ">

                            <td>{{secTask.nwiname}}</td>
                            <td>{{secTask.approved + secTask.notapproved }}</td>
                            <td>{{secTask.approved}}</td>
                            <td>{{secTask.notapproved}}</td>
                            <td>
                                <ng-template
                                        [ngIf]=" secTask.status=='Upload Justification'">
                                    <span style=" font-size: 10px;"
                                          class="badge badge-info">
                                    Approved For Justification
                                    </span>
                                </ng-template>
                                <ng-template
                                        [ngIf]=" secTask.status=='Vote ON NWI'">
                                    <span style=" font-size: 10px;"
                                          class="badge badge-info">
                                    Voting Ongoing
                                    </span>
                                </ng-template>
                                <ng-template
                                        [ngIf]=" secTask.status=='NWI Rejected'">
                                    <span style=" font-size: 10px;"
                                          class="badge badge-danger">
                                    Rejected
                                    </span>
                                </ng-template>


                            </td>

                            <td>

                                <a (click)="onOpenModalVote(secTask,'viewVotes')"
                                   class="btn btn-info tooltips"
                                   data-placement="top"
                                   data-original-title="Upload NWI">View Votes</a>
                            </td>
                            <td>
                                <a (click)="onOpenModalVote(secTask,'edit')"
                                   class="btn btn-info tooltips"
                                   data-placement="top"
                                   data-original-title="Upload NWI">View NWI</a>
                                <br>

                                <a *ngIf="secTask.status=='Vote ON NWI'"
                                   (click)="approveNwi(secTask.nwi_ID)"
                                   class="btn btn-success tooltips"
                                   data-placement="top"
                                   data-original-title="Upload NWI">Approve/Reject Nwi</a>


                            </td>


                        </tr>
                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </div>
</div>


<div class="modal fade " id="updateNWIModal" tabindex="-1" role="dialog"
aria-labelledby="updateExampleModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-lg modal-xl" role="document" style="width: 100%">
<div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="updateExampleModalLabelB">Proposal for
            New Work
            Item</h5>
        <button type="button" class="close" data-dismiss="modal"
                aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <form #editForm="ngForm" (ngSubmit)="saveNwi(editForm)" [formGroup]="stdNwiFormGroup">
        <div class="modal-body">
            <div class="row">
                <div class="form-group col-6">
                    <label><b>Enter Proposal title:</b></label>
                    <mat-form-field class="example-full-width has-label"
                                    [ngClass]="displayFieldCss(stdNwiFormGroup, 'proposalTitle')">
                        <input type="text"
                               matInput
                               ngModel="{{nwiRequest?.subject}}"

                               id="proposalTitle"
                               placeholder="Indicate subject matter of the proposed new standard"
                               (ngModelChange)="textValidationType($event)"
                               formControlName="proposalTitle">
                        <app-field-error-display
                                [displayError]="isFieldValid(stdNwiFormGroup, 'proposalTitle')"
                                errorMsg="Please Enter Proposal Title">
                        </app-field-error-display>
                    </mat-form-field>


                </div>
                <div class="form-group col-6">
                    <label><b>Scope</b></label>
                    <mat-form-field class="example-full-width has-label"
                                    [ngClass]="displayFieldCss(stdNwiFormGroup, 'scope')">
                        <textarea type="text"
                                  matInput
                                  id="scope"
                                  ngModel="{{nwiRequest?.description}}"

                                  placeholder="Give a clear indication of the coverage of the proposed new standard"
                                  (ngModelChange)="textValidationType($event)"
                                  formControlName="scope"></textarea>
                        <app-field-error-display
                                [displayError]="isFieldValid(stdNwiFormGroup, 'scope')"
                                errorMsg="Please Enter Scope">
                        </app-field-error-display>
                    </mat-form-field>

                </div>
            </div>

            <div class="row">
                <div class="form-group col-12">

                    <label><b>Purpose & application</b><span
                            data-toggle="tooltip"
                            data-placement="right"
                            class="badge badge-success"
                            title="The justification information should be based on the following, inter alia:
(i) Importance of economic field
(ii) Degree of economic benefit
(iii) Importance as export item
(iv) Capacity as import substitute
(v) Level of consumer protection
(vi) Availability of reference material indicating whether the proposal is for adoption or adaption of the reference material
(vii) Availability of testing facilities
(viii) Volume of production or operation
(x) Ease of adoption and implementation
(xi) Transfer of technology">i</span></label>
                    <mat-form-field class="example-full-width has-label"
                                    [ngClass]="displayFieldCss(stdNwiFormGroup, 'purpose')">
                        <textarea type="text"
                                  matInput
                                  id="purpose"
                                  placeholder="Give specific aims and reasons for the standard and main interests to benefit from the standard. Mention any relevant problems in the industry or technology."
                                  (ngModelChange)="textValidationType($event)"
                                  formControlName="purpose"></textarea>
                        <app-field-error-display
                                [displayError]="isFieldValid(stdNwiFormGroup, 'purpose')"
                                errorMsg="Please Enter Purpose">
                        </app-field-error-display>
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
<!--                                    <div class="row col-12">-->
<!--                                        <div class="form-group col-12">-->
<!--                                            <label><b>Upload annex for Purpose &-->
<!--                                                application(optional)</b></label>-->
<!--                                            <form #demoForm="ngForm">-->
<!--                                                <file-upload [(ngModel)]="uploadedFiles"-->
<!--                                                             name="uploadedFiles" fileslimit="2"-->
<!--                                                             accept=".pdf, .doc, .docx"></file-upload>-->
<!--                                                <input class="form-control one-column-input"-->
<!--                                                       ngModel="TSCSEC Annex Upload"-->
<!--                                                       name="DocDescription" type="hidden">-->
<!--                                            </form>-->
<!--                                        </div>-->
<!--                                    </div>-->


            </div>

            <div class="row">
<!--                                    <div class="form-group col-6">-->
<!--                                        <label><b>Target Date</b></label>-->
<!--                                        <mat-form-field class="example-full-width has-label"-->
<!--                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'targetDate')">-->
<!--                                            <input type="date"-->
<!--                                                   matInput-->
<!--                                                   id="targetDate"-->
<!--                                                   placeholder="Target Date"-->
<!--                                                   formControlName="targetDate">-->
<!--                                            <app-field-error-display-->
<!--                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'targetDate')"-->
<!--                                                    errorMsg="Please Enter Target Date">-->
<!--                                            </app-field-error-display>-->
<!--                                        </mat-form-field>-->


<!--                                    </div>-->
                <div class="form-group col-6">
                    <label><b>Similar Standards/Subject of
                        Standardization</b></label>
                    <ng-select style="" placeholder="Please Select an option"
                                   formControlName="similarStandards"
                                   id="similarStandards" name="similarStandards">
                            <ng-option
                                    *ngFor="let app of loadedStandards"
                                    [value]="app.standardTitle + app.standardNumber">{{app.standardTitle}} {{app.standardNumber}} </ng-option>
                        </ng-select>

                </div>
            </div>
            <div class="row">
<!--                                    <div class="row col-12">-->
<!--                                        <div class="form-group col-12">-->
<!--                                            <label><b>Upload All Relevant Documents</b></label>-->
<!--                                            <form #demoForm="ngForm">-->
<!--                                                <file-upload [(ngModel)]="uploadedFilesB"-->
<!--                                                             name="uploadedFilesB"-->
<!--                                                             accept=".pdf, .doc, .docx"></file-upload>-->
<!--                                                <input class="form-control one-column-input"-->
<!--                                                       ngModel="RelevantDocumentsNWI Upload"-->
<!--                                                       name="DocDescription" type="hidden">-->
<!--                                            </form>-->
<!--                                        </div>-->
<!--                                    </div>-->

                <div class="form-group col-6">
                    <label><b>Liaison Organization/or interested parties</b></label>

                    <ng-multiselect-dropdown
                            [placeholder]="'Select Liaison Organization'"
                            [settings]="dropdownSettings"
                            [data]="dropdownList"
                            (onSelect)="onItemSelect($event)"
                            (onSelectAll)="onSelectAll($event)"
                            [class.is-invalid]="formStdRequest?.liaisonOrganisationData?.errors?.required && formStdRequest?.liaisonOrganisationData?.touched"
                            formControlName="liaisonOrganisationData"
                            name="liaisonOrganisationData">
                    </ng-multiselect-dropdown>
                    <span *ngIf="formStdRequest?.liaisonOrganisationData?.errors?.required && formStdRequest?.liaisonOrganisationData?.touched"
                          style="color: red;">Liaison Organization is required </span>

                </div>
            </div>
            <div class="row">
                <div class="row col-12">
                    <div class="form-group col-12">
                        <label><b>Upload Any Reference Documents(Optional)</b></label>
                        <form #demoForm="ngForm">
                            <file-upload [(ngModel)]="uploadedFilesC"
                                         name="uploadedFilesC"
                                         accept=".pdf, .doc, .docx"></file-upload>
                            <input class="form-control one-column-input"
                                   ngModel="ReferenceDocumentsNWI Upload"
                                   name="DocDescription" type="hidden">
                        </form>
                    </div>
                </div>
            </div>

<!--                                <h5><b>Preparatory Work</b></h5>-->
<!--                                <div class="row">-->
<!--                                    <div class="form-check col-6">-->
<!--                                        <input-->
<!--                                                aria-describedby="inputGroup-sizing-sm"-->
<!--                                                aria-label="Small"-->
<!--                                                class="one-column-input"-->
<!--                                                formControlName="draftAttached" value="0"-->
<!--                                                id="defaultCheck1" type="checkbox">-->
<!--                                        <label class="form-check-label" for="defaultCheck1">-->
<!--                                            A draft is attached-->
<!--                                        </label>-->

<!--                                    </div>-->
<!--                                    <div class="form-check col-6">-->
<!--                                        <input-->
<!--                                                aria-describedby="inputGroup-sizing-sm"-->
<!--                                                aria-label="Small"-->
<!--                                                class=" one-column-input"-->
<!--                                                formControlName="outlineAttached"-->
<!--                                                id="defaultCheck2" type="checkbox">-->
<!--                                        <label class="form-check-label" for="defaultCheck2">-->
<!--                                            An outline is attached-->
<!--                                        </label>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="row">-->
<!--                                    <div class="form-check col-6">-->
<!--                                        <input-->
<!--                                                aria-describedby="inputGroup-sizing-sm"-->
<!--                                                aria-label="Small"-->
<!--                                                class="one-column-input"-->
<!--                                                formControlName="draftOutlineImpossible"-->
<!--                                                id="defaultCheck3" type="checkbox">-->
<!--                                        <label class="form-check-label" for="defaultCheck3">-->
<!--                                            It is not possible to attach either a draft or-->
<!--                                            outline-->
<!--                                        </label>-->
<!--                                    </div>-->
<!--                                    <div class="form-check col-6">-->
<!--                                        <input-->
<!--                                                aria-describedby="inputGroup-sizing-sm"-->
<!--                                                aria-label="Small"-->
<!--                                                class=" one-column-input"-->
<!--                                                formControlName="outlineSentLater"-->
<!--                                                id="defaultCheck4" type="checkbox">-->
<!--                                        <label class="form-check-label" for="defaultCheck4">-->
<!--                                            An outline will be sent later-->
<!--                                        </label>-->
<!--                                    </div>-->

<!--                                </div>-->
            <div class="row">
                <div class="form-group col-6">
                    <label><b>Enter Name of proposer</b></label>
                    <input
                            aria-describedby="inputGroup-sizing-sm"
                            aria-label="Small"
                            class="form-control one-column-input" readonly
                            ngModel="{{nwiRequest?.name}}"
                            value="{{nwiRequest?.name}}"
                            name="nameOfProposer"
                            formControlName="nameOfProposer"
                            type="text">
                </div>
                <div class="form-group col-6">
                    <label><b>Organization</b></label>
                    <input
                            aria-describedby="inputGroup-sizing-sm"
                            aria-label="Small"
                            class="form-control one-column-input"
                            readonly
                            ngModel="{{nwiRequest?.organisationName}}"
                            value="{{nwiRequest?.organisationName}}"
                            formControlName="organization"
                            name="organization"
                            type="text">
                </div>
            </div>
            <div class="row">
                <div class="form-group col-6">
                    <label><b>Date of Circulation</b></label>
                    <mat-form-field class="example-full-width has-label"
                                    [ngClass]="displayFieldCss(stdNwiFormGroup, 'circulationDate')">
                        <input type="date"
                               matInput
                               id="circulationDate"
                               placeholder="Circulation Date"
                               formControlName="circulationDate">
                        <app-field-error-display
                                [displayError]="isFieldValid(stdNwiFormGroup, 'circulationDate')"
                                errorMsg="Please Enter Circulation Date">
                        </app-field-error-display>
                    </mat-form-field>
                </div>
                <div class="form-group col-6">
                    <label><b>Closing Date</b></label>
                    <mat-form-field class="example-full-width has-label"
                                    [ngClass]="displayFieldCss(stdNwiFormGroup, 'closingDate')">
                        <input type="date"
                               matInput
                               id="closingDate"
                               placeholder="Closing Date"
                               formControlName="closingDate">
                        <app-field-error-display
                                [displayError]="isFieldValid(stdNwiFormGroup, 'closingDate')"
                                errorMsg="Please Enter Closing Date">
                        </app-field-error-display>
                    </mat-form-field>
                </div>
            </div>

            <div class="row">
<!--                                    <div class="form-group col-6">-->
<!--                                        <label><b>Date of presentation</b></label>-->
<!--                                        <mat-form-field class="example-full-width has-label"-->
<!--                                                        [ngClass]="displayFieldCss(stdNwiFormGroup, 'dateOfPresentation')">-->
<!--                                            <input type="date"-->
<!--                                                   matInput-->
<!--                                                   id="dateOfPresentation"-->
<!--                                                   placeholder="Presentation Date"-->
<!--                                                   formControlName="dateOfPresentation">-->
<!--                                            <app-field-error-display-->
<!--                                                    [displayError]="isFieldValid(stdNwiFormGroup, 'dateOfPresentation')"-->
<!--                                                    errorMsg="Please Enter Presentation Date">-->
<!--                                            </app-field-error-display>-->
<!--                                        </mat-form-field>-->
<!--                                    </div>-->
                <div class="form-group col-6">
                    <label><b>Sector</b></label>
                    <input
                            aria-describedby="inputGroup-sizing-sm"
                            aria-label="Small"
                            formControlName="nameOfTC"
                            class="form-control one-column-input" readonly
                            ngModel="{{nwiRequest?.departmentName}}"
                            value="{{nwiRequest?.departmentName}}"
                            placeholder="" name="nameOfTC"
                            type="text">
                </div>

                <div class="form-group col-6">
                    <label><b>Reference Number given by
                        Secretariat</b></label>
                    <input
                            aria-describedby="inputGroup-sizing-sm"
                            aria-label="Small"
                            class="form-control one-column-input" readonly
                            ngModel="{{nwiRequest?.requestNumber}}"
                            value="{{nwiRequest?.requestNumber}}"

                            formControlName="referenceNumber"
                            placeholder="" name="referenceNumber"
                            type="text">

                </div>
            </div>

            <div class="row">


            </div>

            <div class="form-group">
                <input
                        aria-describedby="inputGroup-sizing-sm"
                        aria-label="Small"
                        class="form-control one-column-input" hidden
                        type="text"
                        ngModel="{{nwiRequest?.id}}"
                        formControlName="standardId" value="{{nwiRequest?.id}}">
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" #closeModal
                    (click)="hideModel()" data-dismiss="modal">Close
            </button>
            <button class="btn btn-info tooltips" type="submit">SUBMIT</button>

        </div>
    </form>
</div>
</div>
</div>
<div class="modal fade" id="viewNwi" tabindex="-1" role="dialog"
aria-labelledby="updateExampleModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-lg modal-xl" role="document">
<div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="updateExampleModalLabelC">NEW WORK
            ITEM</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class=" col-12">
                <ul class="list-group">
                    <li class="list-group-item active">New Work Item Details</li>

                    <div *ngFor="let nwiActionRequest of nwiItem let i= index; ">


                        <li style="background: lightgray"
                            class="list-group-item">{{"Proposal Title: " + nwiActionRequest?.proposalTitle}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Scope: " + nwiActionRequest?.scope}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Purpose: " + nwiActionRequest?.purpose}}</li>
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"Target Date: " + nwiActionRequest?.targetDate}}</li>-->
                        <li style="background: lightgray"
                            class="list-group-item">{{"Similar Standards: " + nwiActionRequest?.similarStandards}}</li>
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"Liaison Organization: " + nwiActionRequest?.liaisonOrganisation}}</li>-->
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"Preparatory Work-A draft is attached: " + nwiActionRequest?.draftAttached}}</li>-->
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"An outline is attached: " + nwiActionRequest?.outlineAttached}}</li>-->
                        <li style="background: lightgray"
                            class="list-group-item">{{"It is not possible to attach either a draft or outline: " + nwiActionRequest?.outlineAttached}}</li>
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"An outline will be sent later: " + nwiActionRequest?.outlineSentLater}}</li>-->
                        <li style="background: lightgray"
                            class="list-group-item">{{"Name of proposer: " + nwiActionRequest?.nameOfProposer}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Organization: " + nwiActionRequest?.organization}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Date of Circulation: " + nwiActionRequest?.circulationDate}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Closing Date: " + nwiActionRequest?.closingDate}}</li>
<!--                                            <li style="background: lightgray"-->
<!--                                                class="list-group-item">{{"Date of Presentation: " + nwiActionRequest?.dateOfPresentation}}</li>-->
                        <li style="background: lightgray"
                            class="list-group-item">{{"Sector: " + nwiActionRequest?.nameOfTC}}</li>
                        <li style="background: lightgray"
                            class="list-group-item">{{"Reference Number given by Secretariat: " + nwiActionRequest?.id}}</li>
                    </div>

                    <br><br>
                    <li style="background: lightgray">
                        <div class="material-datatables">
                            <table class="table table-striped table-bordered table-hover"
                                   datatable
                                   [dtOptions]="dtOptions" [dtTrigger]="dtTrigger5">
                                <thead>
                                <tr>
                                    <th class="task">Document Name</th>
                                    <th class="task">Descritpion</th>

                                    <th class="task">Action</th>

                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let doc of docs let i= index; ">

                                    <td>{{doc.name}}</td>
                                    <td>{{doc.description}}</td>

                                    <td>
                                        <button class="btn btn-info tooltips"
                                                style="width: inherit"
                                                (click)="viewPdfFile( doc.id,doc?.name, 'application/pdf')"
                                                data-placement="top"
                                        ><i
                                                class="fa fa-eye"></i> View
                                        </button>
                                    </td>

                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </li>

                </ul>
            </div>
        </div>

        <br>

    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" #closeModal
                (click)="hideModel()"
                data-dismiss="modal">Close
        </button>

    </div>
</div>
</div>
</div>
<div class="modal fade " id="viewVotes" tabindex="-1" role="dialog"
aria-labelledby="updateExampleModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-lg modal-xl" role="document" style="width: 100%">
<div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="updateExampleModalLabelD">View Votes</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row col-12">
            <div class="form-group col-12">
                <label><b>Votes</b></label>
                <div class="material-datatables">
                    <table class="table table-striped table-bordered table-hover"
                           datatable
                           [dtOptions]="dtOptions" [dtTrigger]="dtTrigger3">
                        <thead>
                        <tr>
                            <th class="id">No</th>
                            <th class="action">Vote By</th>
                            <th class="action">Decision</th>
                            <th class="action">Comment</th>

                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let voteRetrievedS of voteRetrieved let i= index; ">
                            <td>{{i + 1}}</td>
                            <td>{{voteRetrievedS.vote_By}}</td>
                            <td>
                                <ng-template
                                        [ngIf]=" voteRetrievedS.decision=='true'">
                                    Approved
                                </ng-template>
                                <ng-template
                                        [ngIf]=" voteRetrievedS.decision=='false'">
                                    Disapproved
                                </ng-template>

                            </td>
                            <td>{{voteRetrievedS.reason}}</td>

                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
                (click)="hideModel()" data-dismiss="modal">Close
        </button>
    </div>
</div>
</div>
</div>

