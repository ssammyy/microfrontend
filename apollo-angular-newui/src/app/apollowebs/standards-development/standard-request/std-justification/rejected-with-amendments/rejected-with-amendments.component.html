<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-primary card-header-icon">
                <div class="card-icon">
                    <i class="material-icons">assignment</i>
                </div>
                <h4 class="card-title">Deferred With Amendments <small
                        class="resolved-pill">{{rejectedWithAmendments.length}}
                    Justification</small>
                </h4>

            </div>
            <div class="card-body">
                <div class="toolbar">

                </div>
                <div class="mat-elevation-z8">
                    <mat-form-field appearance="standard" style="width:20%; float: right">
                        <mat-label>Search</mat-label>
                        <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input>
                    </mat-form-field>
                    <table class="table table-striped table-bordered table-hover" mat-table [dataSource]="dataSourceC"
                           matSort style="width: 100%">

                        <!-- ID Column -->
                        <ng-container matColumnDef="sl">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Sl No.</th>
                            <td mat-cell *matCellDef="let row"> {{row.sl}} </td>
                        </ng-container>

                        <!-- Progress Column -->
                        <ng-container matColumnDef="edition">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Edition</th>
                            <td mat-cell *matCellDef="let row"> {{row.edition}} </td>
                        </ng-container>

                        <!-- Name Column -->
                        <ng-container matColumnDef="title">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Title</th>
                            <td mat-cell *matCellDef="let row"> {{row.title}} </td>
                        </ng-container>

                        <!-- Fruit Column -->
                        <ng-container matColumnDef="spcMeetingDate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> SPC Meeting
                                Date
                            </th>
                            <td mat-cell *matCellDef="let row"> {{row.spcMeetingDate}} </td>
                        </ng-container>
                        <ng-container matColumnDef="preparationDate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Justification Preparation Date
                            </th>
                            <td mat-cell *matCellDef="let row"> {{formatFormDate(row.createdOn)}} </td>
                        </ng-container>

                        <ng-container matColumnDef="departmentId">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Department</th>
                            <td mat-cell *matCellDef="let row"> {{row.departmentId}} </td>
                        </ng-container>

                        <ng-container matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef> Actions</th>

                            <td mat-cell *matCellDef="let row">
                                <a (click)="onOpenModalJustification(row,'view')"
                                   class="btn btn-info tooltips"
                                   data-placement="top"
                                   data-original-title="Review"> View</a>
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                        <!-- Row shown when there is no matching data. -->
                        <tr class="mat-row" *matNoDataRow>
                            <td class="mat-cell" colspan="4">
                                "{{input.value}}"
                            </td>
                        </tr>
                    </table>

                    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"
                                   aria-label="Select page of users"></mat-paginator>
                </div>


            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="justificationDecisionModal" tabindex="-1" role="dialog"
     aria-labelledby="updateExampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">SPC JUSTIFICATION</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">


                <div class="row">
                    <div class=" col-12">
                        <ul class="list-group">
                            <li class="list-group-item active">Justification
                                Details
                            </li>
                        </ul>
                        <form #editForm="ngForm">
                            <div class="modal-body">
                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Technical Committee</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.departmentId}}" readonly
                                                value="{{actionRequest?.departmentId}}"
                                                name="tcId"
                                                type="text">
                                    </div>

                                    <div class="form-group col-6">
                                        <label><b>Department</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.tcId}}"
                                                name="departmentId" aria-label="Small"
                                                readonly
                                                type="text">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>SL</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.sl}}"
                                                readonly

                                                name="sl"
                                                type="text">

                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Request No.</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.requestNo}}"
                                                readonly
                                                value="{{actionRequest?.requestNo}}"
                                                name="requestNo"
                                                placeholder=" " type="text">

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Title</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.title}}"
                                                readonly
                                                value="{{actionRequest?.title}}"
                                                name="title"
                                                type="text">
                                    </div>

                                    <div class="form-group col-6">
                                        <label><b>TC Secretary</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{userDetails?.firstName+ ' '+ userDetails?.lastName}}"
                                                name="tcSecName"
                                                readonly
                                                type="text">

                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>Requested By</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.requestedBy}}"
                                                readonly
                                                value="{{actionRequest?.requestedBy}}"
                                                name="requestedBy"
                                                type="text">
                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>TC Acceptance Date</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.tcAcceptanceDate}}"
                                                readonly
                                                value="{{actionRequest?.tcAcceptanceDate}}"
                                                name="tcAcceptanceDate"
                                                type="text">
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="form-group col-6">
                                        <label><b>SPC Preparation Date</b></label>
                                        <mat-form-field>
                                            <input matInput [matDatepicker]="picker" [min]="todayDate"
                                                   placeholder="Spc Meeting Date" name="spcMeetingDate" ngModel
                                                   required>
                                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                            <mat-datepicker #picker></mat-datepicker>
                                        </mat-form-field>
                                    </div>

                                    <div class="form-group col-6">
                                        <label><b>Edition</b></label>
                                        <mat-form-field>
                                            <mat-select aria-label="Small"
                                                        required
                                                        ngModel="{{actionRequest?.edition}}" name="edition"
                                                        (selectionChange)="onSelectOption($event.value)">

                                                <mat-option value="First" class="dropdown-item"> First</mat-option>
                                                <mat-option value="Second" class="dropdown-item"> Second
                                                </mat-option>
                                                <mat-option value="Third" class="dropdown-item"> Third</mat-option>
                                                <mat-option value="Fourth" class="dropdown-item">Fourth</mat-option>
                                                <mat-option value="Fifth" class="dropdown-item">Fifth</mat-option>
                                                <mat-option value="Sixth" class="dropdown-item">Sixth</mat-option>
                                                <mat-option value="Other" class="dropdown-item">Other</mat-option>


                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field *ngIf="otherSelected">
                                            <input placeholder="Enter Other Option" matInput name="otherOption">
                                        </mat-form-field>
                                    </div>

                                </div>

                                <h3 class="modal-title"><b>ISSUES ADDRESSED</b></h3>
                                <div class="row">
                                    <div class="form-group col-10">
                                        <label><b>Scope</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.scope}}"
                                                name="scope"
                                                type="text">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-10">
                                        <label><b>Purpose And Application</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.purpose}}"
                                                name="purpose"
                                                type="text">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-10">
                                        <label><b>Intended Users</b></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm"
                                                aria-label="Small"
                                                class="form-control one-column-input"
                                                ngModel="{{actionRequest?.intendedUsers}}"
                                                name="intendedUsers"
                                                type="text">
                                    </div>
                                </div>
                                <div class="form-group">

                                    <input
                                            aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                            class="form-control one-column-input" hidden
                                            ngModel="{{actionRequest?.taskId}}" name="taskId"
                                            type="text">
                                    <input hidden ngModel="{{actionRequest?.nwiId}}"
                                           value="{{actionRequest?.nwiId}}" name="nwiId" id="nwiId">
                                    <input hidden ngModel="{{actionRequest?.id}}"
                                           value="{{actionRequest?.id}}" name="id" id="id">
                                    <input hidden ngModel="{{userDetails?.id}}"
                                           value="{{userDetails?.id}}" name="tcSecretary" id="tcSecretary">
                                </div>

                            </div>
                            <div class="material-datatables">
                                <table class="table table-striped table-bordered table-hover"
                                       datatable
                                       [dtOptions]="dtOptions" [dtTrigger]="dtTrigger4">
                                    <thead>
                                    <tr>
                                        <th class="task">Document Name</th>
                                        <th class="task">Descritpion</th>

                                        <th class="task">Action</th>

                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let doc of docs let i= index; ">

                                        <td>{{doc.name}}</td>
                                        <td>{{doc.description}}</td>

                                        <td>
                                            <button class="btn btn-info tooltips"
                                                    style="width: inherit"
                                                    (click)="viewPdfFile( doc.id,doc?.name, 'application/pdf')"
                                                    data-placement="top"
                                            ><i
                                                    class="fa fa-eye"></i> View
                                            </button>
                                        </td>

                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div *ngFor="let actionRequest of stdJustificationDecision let i= index; ">
                                <div class="row">
                                    <div class=" col-12">
                                        <ul class="list-group">
                                            <li class="list-group-item active">Decision
                                                Details
                                            </li>

                                            <li style="background: lightgray"
                                                class="list-group-item">{{"Decision: " + actionRequest?.decision}}</li>

                                            <li style="background: lightgray"
                                                class="list-group-item">{{"Reason: " + actionRequest?.reason}}</li>

                                        </ul>
                                    </div>
                                </div>
                            </div>


                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" #closeModal
                                        (click)="hideModel()" data-dismiss="modal">Close
                                </button>
                                <div *ngIf="roles?.includes('TC_SEC_SD_READ') || roles?.includes( 'STANDARDS_DEVELOPMENT_FULL_ADMIN')">

                                    <button class="btn btn-info" (click)="uploadJustification(editForm.value)">
                                        Resubmit
                                    </button>

                                </div>

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
   
