<div class="container-fluid" style="margin-top: 5%" id="main-container">
<div  class="loading-spinner ">
<ngx-spinner
bdColor="rgba(51,51,51,0.8)"
size="medium"
color="#fff"
type="ball-scale-multiple"
>
<p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner>
</div>
<div class="main-content" >
<div class="container-fluid">
<div class="row">
<div class="col-md-12">
<div class="card">
<div class="card-header card-header-primary card-header-icon">
<div class="card-icon">
<i class="material-icons">assignment</i>
</div>
<h4 class="card-title">Upload Standard Proposal</h4>
</div>
<div class="card-body">
<div class="toolbar">

</div>
<div class="material-datatables">
    <table  class="table table-striped table-bordered table-hover" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
        <thead>
        <tr>
            <th>#</th>
            <th class="knw">Request Number</th>
            <th class="sl">Name</th>
            <th class="sl">Phone</th>
            <th class="requestNumber">Organisation Name</th>
            <th class="knw">Subject</th>
            <th>Department</th>
            <th>Assigned To</th>
            <th>Date Submitted</th>
            <th class="action">Action</th>
        </tr>
        </thead>
        <tbody>
        <tr  *ngFor="let nwaRequestList of nwaRequestLists let i=index">
            <td>{{i+1}}</td>
            <td>{{nwaRequestList.requestNumber}}</td>
            <td>{{nwaRequestList.name}}</td>
            <td>{{nwaRequestList.phone}}</td>
            <td>{{nwaRequestList.organisationName}}</td>
            <td>{{nwaRequestList.subject}}</td>
            <td>{{nwaRequestList.departmentName}}</td>
            <td>{{nwaRequestList.tcSecAssigned}}</td>
            <td>{{nwaRequestList.submissionDate | date: 'dd/MM/yyyy' }}</td>
            <td ><a  (click)="onOpenModal(nwaRequestList,'prepareJustification')" class="btn btn-info btn-sm tooltips" data-placement="top" style="width: 130px" data-original-title="Approve">Prepare Proposal</a></td>

        </tr>
        </tbody>
    </table>
    <div class="modal fade" id="prepareJustification" tabindex="-1" role="dialog" aria-labelledby="prepareJustificationLabel" aria-hidden="true">a
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="prepareJustificationLabel">View Standard</h3>
                    <button type="button" #closeModalUploadJustification class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                    <div class="modal-body">
                            <form (ngSubmit)="uploadProposal()" [formGroup]="isProposalFormGroup" class="form">
                            <div class="form-body">
                                <div class="row col-12">
                                    <div class="form-group col-12">
                                        <label><b>Enter Document Type</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <input aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                               class="form-control one-column-input" value="{{proposal_doc_name}}" formControlName="proposal_doc_name" name="proposal_doc_name"
                                               placeholder="name" type="text" disabled>
                                    </div>
                                </div>
                                <div class="row col-12">
                                    <div class="form-group col-6">
                                        <label><b>Uploaded By</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                class="form-control one-column-input" formControlName="tcSecName" value="{{fullname}}" name="tcSecName"
                                                placeholder="Name" type="text" disabled>
                                    </div>
                                    <div class="form-group col-6">
                                        <label><b>Date of Circulation</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                class="form-control one-column-input" formControlName="circulationDate" name="circulationDate"
                                                placeholder="circulationDate" type="date" >
                                    </div>
                                </div>

                                <h4 style="font-weight: bold">
                                    The Kenya Bureau of Standards intends to adopt the International Standard as detailed here below
                                </h4>
                                <div class="row col-12">
                                    <div class="form-group col-6">
                                        <label><b>Standard Number</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <input
                                                aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                class="form-control one-column-input"  formControlName="iStandardNumber" name="iStandardNumber"
                                                placeholder="International Standard Number" type="text" >
                                    </div>
                                    <div class="form-group col-12">
                                        <label><b>Title</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <textarea aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                  class="form-control one-column-input" formControlName="title" name="title"
                                                  placeholder="International Standard Title" type="text"></textarea>

                                    </div>
                                    <div class="form-group col-12">
                                        <label><b>Scope</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <textarea aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                  class="form-control one-column-input" formControlName="scope" name="scope"
                                                  placeholder="International Standard Scope" type="text"></textarea>

                                    </div>
                                    <div class="form-group col-sm-12">
                                        <label *ngIf="formISProposal.adoptionProposalLink.invalid"><b>Append Link</b><span style="font-size: small; color: red;">(*)Kindly ensure the URL entered is in the correct format and is valid</span></label>
                                        <label *ngIf="formISProposal.adoptionProposalLink.valid"><b>Append Link</b><span style="font-size: small; color: green; font-weight: bold">(*)URL Format has been validated</span></label>
                                        <textarea aria-describedby="inputGroup-sizing-sm" aria-label="Small"
                                                  class="form-control one-column-input" formControlName="adoptionProposalLink" name="adoptionProposalLink"
                                                  placeholder="" type="text"></textarea>

<!--                                        <div *ngIf="formISProposal.adoptionProposalLink.touched && formISProposal.adoptionProposalLink.invalid" >-->
<!--                                            <div *ngIf="formISProposal.adoptionProposalLink.errors.required"> This field is required!</div>-->
<!--                                            <div *ngIf="formISProposal.adoptionProposalLink.errors.url"> invalid URL </div>-->
<!--                                        </div>-->

                                    </div>

                                    <div class="form-group col-12">
                                        <label><b>Select Stakeholders to send Adoption proposal</b><span style="font-size: xx-small; color: red;">(*)Required</span></label>
                                        <ng-multiselect-dropdown
                                                [placeholder]="'Select Stakeholders to send Adoption proposal'"
                                                [settings]="dropdownSettings"
                                                [data]="dropdownList"
                                                (onSelect)="onItemSelect($event)"
                                                (onSelectAll)="onSelectAll($event)"
                                                formControlName="stakeholdersList"
                                                name="stakeholdersList">
                                        </ng-multiselect-dropdown>
                                    </div>

                                    <div class="row col-12">
                                        <br>
                                        <p style="color: red">(*)Type Emails,Phone Number and Names of stake holders that are not on the Dropdown Select List(Comma Separated)</p>
                                        <label><b>Stake Holders Contacts</b><span style="font-size: xx-small; color: red;"></span></label>
                                        <div class="form-group col-4">
                                            <label><b>Names</b><span style="font-size: xx-small; color: red;"></span></label>
                                            <input   aria-describedby="inputGroup-sizing-sm" aria-label="Small" [class.is-invalid]="formISProposal.stakeHolderName.touched && formISProposal.stakeHolderEmail.touched && formISProposal.stakeHolderPhone.touched "
                                                     class="form-control one-column-input" formControlName="stakeHolderName"  name="stakeHolderName"
                                                     placeholder="" type="text">
                                        </div>
                                        <div class="form-group col-4">
                                            <label><b>Email</b><span style="font-size: xx-small; color: red;"></span></label>
                                            <input   aria-describedby="inputGroup-sizing-sm" aria-label="Small" [class.is-invalid]="formISProposal.stakeHolderName.touched && formISProposal.stakeHolderEmail.touched && formISProposal.stakeHolderPhone.touched "
                                                     class="form-control one-column-input" formControlName="stakeHolderEmail"  name="stakeHolderEmail"
                                                     placeholder="" type="text">
                                        </div>
                                        <div class="form-group col-4">
                                            <label><b>Phone Number</b><span style="font-size: xx-small; color: red;"></span></label>
                                            <input   aria-describedby="inputGroup-sizing-sm" aria-label="Small" [class.is-invalid]="formISProposal.stakeHolderName.touched && formISProposal.stakeHolderEmail.touched && formISProposal.stakeHolderPhone.touched "
                                                     class="form-control one-column-input" formControlName="stakeHolderPhone"  name="stakeHolderPhone"
                                                     placeholder="" type="text">
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <button *ngIf="isProposalFormGroup.valid" mat-raised-button
                                                        class="btn btn-success float-right" (click)="onClickAddResource()" type="button" >Add StakeHolder
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-12" *ngIf="isProposalFormGroup.valid">
                                            <div class="table-responsive">
                                                <table  class="table table-striped table-bordered table-hover" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                                                    <thead>
                                                    <tr>
                                                        <th>Names</th>
                                                        <th>Email Address</th>
                                                        <th>Phone Number</th>
                                                        <th></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr *ngFor="let r of dataSaveResourcesRequiredList; let i=index">
                                                        <td>{{r.stakeHolderName}}</td>
                                                        <td>{{r.stakeHolderEmail}}</td>
                                                        <td>{{r.stakeHolderPhone}}</td>
                                                        <td>
                                                            <button (click)="removeDataResource(i)"
                                                                    type="button"
                                                                    class="btn btn-warning btn-sm">
                                                <span class=""
                                                      aria-hidden="true">Remove</span>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                    </div>
                                    <input type="hidden" value="{{actionRequests?.id}}" formControlName="requestId" name="requestId" >
                                </div>
                            </div>
                            </form>

                            <div class="row col-12 float-right modal-footer" *ngIf="isProposalFormGroup.valid">
                                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
                                <button  class="btn btn-sm btn-info float-right" (click)="onClickSaveProposal()" type="button">Submit</button>
                            </div>


                    </div>
                <div class="col-12">
                    <h3 style="font-weight: bold; color: black">NOTE: Absence of any reply or comments shall be deemed to be an acceptance of the proposal for adoption and shall constitute an approval vote.</h3>
                </div>


            </div>
        </div>
    </div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
