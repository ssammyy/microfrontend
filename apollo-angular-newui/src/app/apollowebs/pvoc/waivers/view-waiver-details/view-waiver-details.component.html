<div class="main-content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-primary card-header-icon">
                        <div class="card-icon">
                            <i class="material-icons">handshake</i>
                        </div>
                        <h4 class="card-title" *ngIf="waiverDetails">
                            Waiver Application Details
                            <button class="btn btn-sm btn-default float-right mr-7"
                                    (click)="goBack()"><i class="fa fa-arrow-left"></i> Back
                            </button>
                        </h4>

                    </div>
                    <div class="card-body" *ngIf="waiverDetails">
                        <div class="row">
                            <div class="col-md-2 col-sm-2">
                                <div widget class=" border-0 box-shadow">
                                    <div class="text-center pt-2" style="color: green;">
                                        Exemption Details
                                    </div>
                                    <div class="card-body pt-0 widget-body" *ngIf="waiverDetails.waiver_details">
                                        <table class="table-responsive">
                                            <th>
                                                S/N
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.serialNo ? waiverDetails.waiver_details.serialNo : "NA"}}</td>
                                            </tr>
                                            <th>
                                                KRA PIN
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.kraPin}}</td>
                                            </tr>
                                            <th>
                                                Company Name
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.applicantName }}</td>
                                            </tr>
                                            <th>
                                                Company Email
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.emailAddress}}</td>
                                            </tr>
                                            <th>
                                                Applicant Status
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.reviewStatus}}</td>
                                            </tr>
                                            <th>
                                                Application Date
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.submittedOn | date:'mediumDate'}}</td>
                                            </tr>
                                            <th>
                                                Application Time
                                            </th>
                                            <tr>
                                                <td>{{waiverDetails.waiver_details.submittedOn| date:'shortTime'}}</td>
                                            </tr>
                                        </table>
                                    </div>

                                </div>
                            </div>
                            <div class="col-md-8 col-sm-12">
                                <!-- <div class="d-flex"> -->
                                <mat-tab-group [(selectedIndex)]="activeTab" [disablePagination]="true"
                                               appMatMultilineTab
                                               class="tab-wraps">
                                    <mat-tab tabindex="1" label="Waiver Details">
                                        <b class="text-primary">Waiver Details</b>
                                        <div class="panel" style="max-height: 388px;">
                                            <ul class="w-list-unstyled">
                                                <li class="list-item-accordion">
                                                    <div class="list-title-accordion">Product Description</div>
                                                    <div class="list-text-accordion">{{waiverDetails.waiver_details.productDescription}}</div>
                                                </li>
                                                <li class="list-item-accordion">
                                                    <div class="list-title-accordion">Justification</div>
                                                    <div class="list-text-accordion">{{waiverDetails.waiver_details.justification}}</div>
                                                </li>
                                                <li class="list-item-accordion">
                                                    <div class="list-title-accordion">Address</div>
                                                    <div class="list-text-accordion">{{waiverDetails.waiver_details.address}}</div>
                                                </li>
                                                <li class="list-item-accordion">
                                                    <div class="list-title-accordion">Application Date</div>
                                                    <div class="list-text-accordion">{{waiverDetails.waiver_details.submittedOn| date: 'mediumDate'}}</div>
                                                </li>
                                                <li class="list-item-accordion">
                                                    <div class="list-title-accordion">Application Time</div>
                                                    <div class="list-text-accordion">{{waiverDetails.waiver_details.submittedOn| date: 'shortTime'}}</div>
                                                </li>
                                            </ul>
                                        </div>
                                    </mat-tab>
                                    <mat-tab tabindex="2" label="Products" [hidden]="!waiverDetails.products">
                                        <mat-table class="table-striped table-responsive table-condensed"
                                                   [dataSource]="waiverDetails.products">
                                            <ng-container matColumnDef="serialNo">
                                                <mat-header-cell *matHeaderCellDef>S/N</mat-header-cell>
                                                <mat-cell *matCellDef="let element"> {{element.serialNo}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="hsCode">
                                                <mat-header-cell *matHeaderCellDef>Hs Code</mat-header-cell>
                                                <mat-cell *matCellDef="let element"> {{element.hsCode}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="unit">
                                                <mat-header-cell *matHeaderCellDef>Unit</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.unit}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="quantity">
                                                <mat-header-cell *matHeaderCellDef>Quantity</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.quantity}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="totalAmount">
                                                <mat-header-cell *matHeaderCellDef>Total Amount</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.totalAmount}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="brand">
                                                <mat-header-cell *matHeaderCellDef>Brand</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.brand}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="origin">
                                                <mat-header-cell *matHeaderCellDef>Origin</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.origin}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="productDescription">
                                                <mat-header-cell *matHeaderCellDef>Description</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.productDescription}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="currency">
                                                <mat-header-cell *matHeaderCellDef>Currency</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.currency}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="actions">
                                                <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                                                <mat-cell *matCellDef="let element">
                                                </mat-cell>
                                            </ng-container>
                                            <mat-header-row *matHeaderRowDef="productsColumns"></mat-header-row>
                                            <mat-row *matRowDef="let row; columns: productsColumns;"></mat-row>
                                        </mat-table>
                                    </mat-tab>
                                    <mat-tab tabindex="3" label="Attachments" [hidden]="!waiverDetails.attachments">
                                        <mat-table class="table-striped table-responsive table-condensed"
                                                   [dataSource]="waiverDetails.attachments">
                                            <ng-container matColumnDef="name">
                                                <mat-header-cell *matHeaderCellDef>File Name</mat-header-cell>
                                                <mat-cell *matCellDef="let element"> {{element.name}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="description">
                                                <mat-header-cell *matHeaderCellDef>Description</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.description}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="fileType">
                                                <mat-header-cell *matHeaderCellDef>File Type</mat-header-cell>
                                                <mat-cell
                                                        *matCellDef="let element"> {{element.fileType}} </mat-cell>
                                            </ng-container>
                                            <ng-container matColumnDef="actions">
                                                <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                                                <mat-cell *matCellDef="let element">
                                                    <button (click)="downloadAttachment(element.fileId)">
                                                        <i class="fa fa-download"></i>Download
                                                    </button>
                                                </mat-cell>
                                            </ng-container>
                                            <mat-header-row *matHeaderRowDef="attachmentColumns"></mat-header-row>
                                            <mat-row *matRowDef="let row; columns: attachmentColumns;"></mat-row>
                                        </mat-table>
                                    </mat-tab>
                                    <mat-tab tabindex="4" label="History"
                                             [hidden]="!waiverDetails.remarks_history">
                                        <div class="row">
                                            <div class="col-md-10" *ngFor="let r of waiverDetails.remarks_history">
                                                <div class="media g-mb-30 media-comment">
                                                    <div class="media-body u-shadow-v18 g-bg-secondary g-pa-30">
                                                        <div class="g-mb-15">
                                                            <h5 class="h5 g-color-gray-dark-v1 mb-0">{{r.waiverAction}}</h5>
                                                            <span class="g-color-gray-dark-v4 g-font-size-12">By {{r.names}}</span>
                                                            <span class="g-color-gray-dark-v4 g-font-size-12">, On {{r.createdOn | date}}</span>
                                                        </div>
                                                        <p><b>REMARKS:</b>{{r.remarks}}</p>
                                                        <p><b>DESCRIPTION:</b> {{r.description}}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </mat-tab>
                                </mat-tab-group>
                            </div>
                            <div class="col-md-2 col-sm-12">
                                <h5>Action:</h5>
                                <br/>
                                <div class="card" *ngFor="let task of waiverDetails.tasks">
                                    <div class="text-center pt-2" style="color: green;">
                                        {{task.task}}
                                    </div>
                                    <div class="card-body pt-1 pb-0 widget-body">
                                        <p *ngIf="task.description"><b>DESCRIPTION:</b> {{task.description}}</p>
                                        <div>
                                            <b>REMARKS:</b>
                                            <p>{{task.map.remarks}}</p>
                                        </div>
                                    </div>
                                    <div class="card-footer">
                                        <button class="btn btn-sm btn-primary"
                                                (click)="approveRejectTasks(task.objectId,task.map.waiverId, task.task)">
                                            Approve/Reject/Defer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end content-->
                </div>
                <!--  end card  -->
            </div>
            <!-- end col-md-12 -->
        </div>
        <!-- end row -->
    </div>
</div>