<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Mar 18 2020 20:03:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e70fb3a565ebdc05ddb37cf" data-wf-site="5e70fb3a565ebd99c1db37ce"
      xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <title>KEBS</title>
    <th:block th:include="fragments/general-form.html:: headerfiles"/>
</head>
<body>
<div id="spinnerContainer">
    <div class="spinner"></div>
</div>
<div th:replace="fragments/general-form.html :: dashboard-page"></div>

<div class="dashboard-body">
    <div th:replace="fragments/general-form.html :: side-navigation-bar"></div>
    <div class="main-area">
        <div th:replace="fragments/general-form.html :: content-navigation-bar"></div>
        <section class="dashboard-content">
            <div class="content-wrap">
                <div class="content-container">
                    <h4 class="h3-blue" style="color: #0082f3; font-weight: bold; ">SSF List</h4>
                    <div class="content-block">
                        <div class="content-block-parent" style="flex: 0 75%">
                            <div class="row-table ">
                                <table id="example" class="table table-striped table-bordered" style="width:100%">
                                    <thead>
                                    <tr>
                                        <th>SSF NO</th>
                                        <th>SSF SUBMISSION DATE</th>
                                        <th>BS NUMBER</th>
                                        <th>PRODUCT NAME</th>
                                        <th>BRAND NAME</th>
                                        <th>SAMPLE STATUS</th>
                                        <th>View Details</th>
                                        <!--                                        <th>View PDF</th>-->
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr class="list" th:each="ssfDetails: ${allSSFDetailsList}" style="cursor: pointer">
                                        <td th:text="${ssfDetails?.ssfNo}"></td>
                                        <td th:text="${#dates.format(ssfDetails?.ssfSubmissionDate, 'dd/MM/yyyy')}"></td>
                                        <td th:text="${ssfDetails?.bsNumber}"></td>
                                        <td th:text="${ssfDetails?.productDescription}"></td>
                                        <td th:text="${ssfDetails?.brandName}"></td>
                                        <td style="color: #0082f3" th:text="${ssfDetails?.sampleStatus}"></td>
                                        <!--                                        <td style="color: #0082f3" th:text="${ssfDetails?.sampleStatus} ? 'PAID' : 'NOT PAID'"></td>-->
                                        <!--                                        <td th:text="${invoice?.awardedPermitNumber}"></td>-->

                                        <!--                                        <td th:text="${#dates.format(permit?.dateOfExpiry, 'dd/MM/yyyy')}"></td>-->
                                        <!--                                        <td  style="color: #0082f3" th:text="${permit?.permitStatus}"></td>-->

                                        <!--                                        <td style="color: #20f300; font-weight: bold; " th:if="${permit?.enabled == 1}">Active</td>-->
                                        <!--&lt;!&ndash;                                        <td style="color: Black; font-weight: bold; " th:unless="${permit?.enabled == 10}">Applied</td>&ndash;&gt;-->
                                        <!--                                        <td style="color: #f30014; font-weight: bold; " th:unless="${permit?.enabled == 1}">Expired</td>-->
                                        <!--                                        <td th:text="${complaint?.}"></td>-->
                                        <!--                                        <td sec:authorize="hasAuthority('CD_SUPERVISOR_READ')" th:if="${coc?.assignedStatus == 1}"  th:text="${coc?.assignIoId?.firstName}  + ' ' + ${coc?.assignIoId?.lastName}"></td>-->
                                        <td><a class="filter-link"
                                               th:href="@{/api/qa/inspection/ssf-details(ssfID=${ssfDetails?.id})}">VIEW</a>
                                        </td>
                                        <!--                                        <td><a class="filter-link" th:href="@{/api/kebs/qa/report/proforma-invoice-with-Item(ID=${ssfDetails?.permitId})}">VIEW</a></td>-->
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="filter-block">
                            <div class="filter-block-title">
                                <div class="filter-title">Action:</div>
                            </div>
                            <div>
                                <a style="color: white" onclick="popUpSSFFunction('addSSFDetails');"
                                   class="filter-link">ADD SSF & BS NUMBER</a>

                                <a style="color: white"
                                   th:href="@{/api/qa/permit-details(permitID=${permitDetails.id},userID=${permitDetails?.userId})}"
                                   class="filter-link">GO TO PERMIT DETAILS</a>
                                <!--                                <button id="addParam" class="btn btn-primary"  type="button">ADD PLANT DETAILS</button>-->
                            </div>
                        </div>

                        <div class="qaSSFForm">
                            <form id="qa-ssf-form" name="qa-ssf-form" enctype="multipart/form-data"
                                  th:action="@{/api/qa/kebs/ssf-details-uploads(permitID = ${permitDetails?.id})}"
                                  method="post"
                                  th:object="${SampleSubmissionDetails}">
                                <div class="modal fade" id="qaSSFModal" tabindex="-1" role="dialog"
                                     aria-labelledby="qaSSFModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 style="font-weight: bold; " class="modal-title"
                                                    id="qaSSFModalLabel"><span
                                                        id="spanSSFValue">none</span></h5>
                                                <button type="button" class="close" data-dismiss="modal"
                                                        onClick="refreshPage()"
                                                        aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="form-group">


                                                    <div id="addSSFDetails">
                                                        <input type="hidden" id="description8" name="description"
                                                               th:value="'SSF was added sucessfull'">
                                                        <!--                                            <input type="hidden" id="inspectionScheduledStatus" name="inspectionScheduledStatus" th:value="${activeStatus}">-->
                                                        <label for="ssfNo" class="col-form-label">SSF No:</label>
                                                        <input class="input-field w-input" type="text" max="20"
                                                               id="ssfNo"
                                                               name="ssfNo" th:field="*{ssfNo}" th:required="required">
                                                        <label for="ssfSubmissionDate" class="col-form-label">SSF
                                                            Submission
                                                            Date:</label>
                                                        <input class="input-field w-input" type="date" max="20"
                                                               id="ssfSubmissionDate" name="ssfSubmissionDate"
                                                               th:field="*{ssfSubmissionDate}" th:required="required">
                                                        <label for="bsNumber" class="col-form-label">BS Number:</label>
                                                        <input class="input-field w-input" type="text" max="20"
                                                               id="bsNumber"
                                                               name="bsNumber" th:field="*{bsNumber}"
                                                               th:required="required">
                                                        <label for="brandName" class="col-form-label">Brand
                                                            Name:</label>
                                                        <input id="brandName" name="brandName"
                                                               th:value="${permitDetails?.tradeMark}" type="hidden">
                                                        <input class="input-field w-input" disabled type="text" max="20"
                                                               id="brandName2" name="brandName"
                                                               th:value="${permitDetails?.tradeMark}"
                                                               th:required="required">
                                                        <label for="productDescription" class="col-form-label">Product
                                                            Description:</label>
                                                        <input id="productDescription" name="productDescription"
                                                               th:value="${permitDetails?.commodityDescription}"
                                                               type="hidden">
                                                        <input class="input-field w-input" disabled type="text" max="20"
                                                               id="productDescription2" name="productDescription"
                                                               th:value="${permitDetails?.commodityDescription}"
                                                               th:required="required">
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button class="btn btn-secondary" data-dismiss="modal"
                                                        onClick="refreshPage()"
                                                        type="button">Close
                                                </button>
                                                <input type="submit" id="saveSSfValue" class="btn btn-primary"
                                                       value="Save"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>


                        <!--                        <div sec:authorize="hasAuthority('PERMIT_APPLICATION')" id="idPopUp" class="uploadForm">-->
                        <!--                            <form id="upload-form" name="upload-form" th:action="@{/api/qa/kebs/invoice/create-batch-invoice/save}" method="post" th:object="${NewBatchInvoiceDto}">-->
                        <!--                                <div class="modal fade" id="uploadModal" tabindex="-1" role="dialog"-->
                        <!--                                     aria-labelledby="uploadModalLabel" aria-hidden="true">-->
                        <!--                                    <div class="modal-dialog" role="document">-->
                        <!--                                        <div class="modal-content">-->
                        <!--                                            <div class="modal-header">-->
                        <!--                                                <h5 style="font-weight: bold; " class="modal-title" id="uploadModalLabel"><span id="uploadSpan" >none</span></h5>-->
                        <!--                                                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>-->
                        <!--                                            </div>-->
                        <!--                                            <div class="modal-body">-->
                        <!--                                                <div class="form-group">-->
                        <!--                                                    &lt;!&ndash;                                                    <input type="hidden" id="confirmSampleId"  name="confirmSampleId" th:value="${sampleSubmit?.id}">&ndash;&gt;-->
                        <!--                                                    <div id="addParamBtn">-->
                        <!--                                                        &lt;!&ndash;                                                        <input type="hidden" id="companyProfileId"  name="companyProfileIdeId" th:value="${message}">&ndash;&gt;-->
                        <!--                                                        &lt;!&ndash;                                                        <label for="plantID" class="field-label">Select a Plant:</label>&ndash;&gt;-->
                        <!--                                                        &lt;!&ndash;                                                        <select id="plantID" required class="input-field w-input" name="plantID" th:field="*{plantID}">&ndash;&gt;-->
                        <!--                                                        &lt;!&ndash;                                                            <option value="0">Select one...</option>&ndash;&gt;-->
                        <!--                                                        &lt;!&ndash;                                                            <option  th:each="plant : ${plantsDetails}" th:text="${plant?.buildingName}" th:name="attachedPlantId" th:value="${plant?.id}"></option>&ndash;&gt;-->
                        <!--                                                        &lt;!&ndash;                                                        </select>&ndash;&gt;-->
                        <!--                                                        <label class="field-label" for="select-state">Select-->
                        <!--                                                            Permit:</label>-->
                        <!--                                                        <select name="permitInvoicesID" multiple-->
                        <!--                                                                data-placeholder="Select multiple one after another..."-->
                        <!--                                                                id="select-state" th:field="*{permitInvoicesID}">-->
                        <!--                                                            <option th:each="permitInvoice : ${allPermitInvoiceList}"-->
                        <!--                                                                    th:text="${permitInvoice.brandName}+ '= KSH ' + ${permitInvoice.totalAmount}"-->
                        <!--                                                                    th:value="${permitInvoice.permitRefNumber}"></option>-->
                        <!--                                                            &lt;!&ndash;                                        <option th:each="subRegion : ${subRegions}" th:text="${subRegion.subRegion}" th:value="${subRegion.id}"></option>&ndash;&gt;-->
                        <!--                                                        </select>-->

                        <!--                                                    </div>-->

                        <!--                                                </div>-->
                        <!--                                            </div>-->
                        <!--                                            <div class="modal-footer">-->
                        <!--                                                <button type="button" class="btn btn-secondary" onClick="window.location.reload()" data-mdb-dismiss="modal">Close</button>-->
                        <!--                                                <input type="submit" id="upload" class="btn btn-primary" value="Save"/>-->
                        <!--                                            </div>-->
                        <!--                                        </div>-->
                        <!--                                    </div>-->
                        <!--                                </div>-->
                        <!--                            </form>-->
                        <!--                        </div>-->
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
<div th:replace="fragments/general-form.html :: scripts"></div>


<script>
    document.onreadystatechange = function () {
        showSpinnerOnLoad(document)
    }

    function loadSpinner() {
        showSpinner(document)
    }
</script>
<script>
    $(document).ready(function () {
        var table = $('#example').DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf', 'colvis']
        });

        table.buttons().container()
            .appendTo('#example_wrapper .col-sm-6:eq(0)');
    });
</script>
<script>
    $(document).ready(function () {

        $('select').selectize({
            sortField: 'text'
        });


        $("#plantID").click(function () {
            // let methodId = $("#divisionId").children("option:selected").val()
            let plantID = $("#plantID").val()
            // console.log(categories.length)
            if (plantID !== 0) {
                $.ajax({
                    method: "GET",
                    url: `/api/qa/invoice/permit-invoice-list/${plantID}`,
                    // data: regionId,
                    success(response) {
                        console.log(response)
                        let s = '';
                        s += ' <option value="0">Select One...</option>';
                        for (let i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].permitID + '">' + response[i].brandName + '= KSH ' + response[i].totalAmount + '</option>';
                            // <option th:each="subRegion : ${subRegions}" th:text="${subRegion.subRegion}" th:value="${subRegion.id}"></option>-->
                            // s += ' <option th:each="department : ${departments}" th:text="${department.department}" th:value="${department.id}"></option>';
                        }
                        $("#permitID").html(s);
                    }
                })
            }
        });
    });
</script>
<script>


    let arrHead = ['addParamBtn',];
    let arrHeadSave = ['Please select applicable SMARK',];


    function refreshPage() {
        window.location.reload();
    }


    function popUpSSFFunction(eventAction) {
        let arrHead = ['addSSFDetails'];
        let arrHeadSave = ['Add SSF Details Below'];

        for (let h = 0; h < arrHead.length; h++) {
            if (eventAction !== arrHead[h]) {
                document.getElementById(arrHead[h]).remove();
            } else {
                if (eventAction === arrHead[h]) {
                    document.getElementById('spanSSFValue').innerHTML = arrHeadSave[h];
                    document.getElementById("saveSSfValue").value = 'Save';
                }
            }
        }

        $('.qaSSFForm #qaSSFModal').modal();
    }

    function popUpFunctionUpload(eventAction) {

        for (let h = 0; h < arrHead.length; h++) {
            if (eventAction !== arrHead[h]) {
                document.getElementById(arrHead[h]).remove();
            } else {
                if (eventAction === arrHead[h]) {
                    document.getElementById('uploadSpan').innerHTML = arrHeadSave[h];
                    document.getElementById("upload").value = 'Save';
                }
            }
        }

        $('.uploadForm #uploadModal').modal();
    }

    window.onload = function () {
        setTimeout(function () {
            hello();
        }, 1000);
    }
</script>
</body>
</html>


