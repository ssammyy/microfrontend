<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Mar 18 2020 20:03:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e70fb3a565ebdc05ddb37cf" data-wf-site="5e70fb3a565ebd99c1db37ce"
      xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <title>KEBS</title>
    <th:block th:include="fragments/general-form.html:: headerfiles"/>
    <link rel="stylesheet" th:href="@{/css/pageLoad.css}" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" th:href="@{/css/accordion.css}"/>
    <link rel="stylesheet" th:href="@{/assets/bootstrap3/css/bootstrap.css}"/>
    <!--    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap.min.css"/>-->
    <!--    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.4/css/buttons.bootstrap.min.css"/>-->

    <!--    &lt;!&ndash; Font Awesome &ndash;&gt;-->
    <!--    <link href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" rel="stylesheet"/>-->
    <!--    &lt;!&ndash; Google Fonts &ndash;&gt;-->
    <!--    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>-->
    <!--    &lt;!&ndash; MDB &ndash;&gt;-->
    <!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/2.2.1/mdb.min.css" rel="stylesheet"/>-->
</head>
<body>
<div id ="spinnerContainer"><div class="spinner"></div></div>
<div class="top-bar" th:replace="fragments/general-form.html :: top-bar"></div>
<div class="section">
    <div class="w-layout-grid main-grid">
        <div class="main-grid-side-navigation" id="w-node-d308c123a20f-c123a20d"
             th:replace="fragments/general-form.html :: side-navigation-bar"></div>
        <div id="w-node-27962c2db181-c676b3e3" class="main-content-div">
            <div class="content-nav" th:replace="fragments/general-form.html :: content-navigation-bar"></div>
            <div class="content-wrap">
                <div class="content-container">
                    <h5 style="font-weight: bold; color: #0082f3; font-size: 14px"><u><span th:text="${permitType?.mark}"></span> Permit</u></h5>
                    <div class="content-block">
                        <div class="content-block-parent" style="flex: 0 75%">

                            <div class="sticky" style="margin-bottom: 30px">
                                <h6 class="h3-blue" style="font-weight: bold; font-size: 16px">Permit Details</h6>
                                <div class="applicant_details_container">
                                    <div class="detail-list application_details">
                                        <ul class="w-list-unstyled">
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Permit No. </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.permitNumber}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Name of firm </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.firmName}"></div>
                                            </li>

                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Postal address </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.postalAddress}"></div>
                                            </li>

                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Physical address </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.physicalAddress}"></div>
                                            </li>

                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Telephone number </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.telephoneNo}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Fax No. </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.faxNo}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Email address </div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.email}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Date of Application</div>
                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.createdOn, 'dd/MM/yyyy')}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Date of Issue</div>
                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.dateOfIssue, 'dd/MM/yyyy')}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Date of Expiry</div>
                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.dateOfExpiry, 'dd/MM/yyyy')}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Description of commodity</div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.commodityDescription}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Trade Mark</div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.tradeMark}"></div>
                                            </li>
                                            <li th:if="${permitType?.localForeignStatus == 1}" class="list-item-accordion">
                                                <div class="list-title-accordion">APPLICATION TYPE</div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.permitForeignStatus} ? 'FOREGIN' : 'DOMESTIC'" ></div>
                                            </li>

                                        </ul>
                                    </div>
                                    <div class="application_reports">
                                        <ul class="w-list-unstyled">
<!--                                            <li class="list-item-accordion">-->
<!--                                                <div class="list-title-accordion">Approved By</div>-->
<!--&lt;!&ndash;                                                <div class="list-text-accordion" style="color: #0082f3" th:text="${cdDetails?.assignedStatus} ? ${cdDetails?.assignedInspectionOfficer?.firstName}+ ' ' +${cdDetails?.assignedInspectionOfficer?.lastName} : 'NOT ASSIGNED'"></div>&ndash;&gt;-->
<!--                                                &lt;!&ndash;                                                     th:if="${cdDetails?.assignedStatus == 1}" th:text="${cdDetails?.assignedInspectionOfficer?.firstName}+ ' ' +${cdDetails?.assignedInspectionOfficer?.lastName}"></div>&ndash;&gt;-->
<!--                                                &lt;!&ndash;                                                <div class="list-text-accordion"&ndash;&gt;-->
<!--                                                &lt;!&ndash;                                                     th:if="${cdDetails?.assignedStatus != 1}">&ndash;&gt;-->
<!--                                                &lt;!&ndash;                                                    NOT ASSIGNED&ndash;&gt;-->
<!--                                                &lt;!&ndash;                                                </div>&ndash;&gt;-->
<!--                                            </li>-->
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Assigned Officer</div>
                                                <div class="list-text-accordion" style="color: #0082f3" th:text="${permitDetails?.assignOfficerStatus} ? ${officerAssigned?.firstName}+ ' ' +${officerAssigned?.lastName} : 'NOT ASSIGNED'"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Appointed Assessor</div>
                                                <div class="list-text-accordion" style="color: #0082f3" th:text="${permitDetails?.assignAssessorStatus} ? ${assessorAssigned?.firstName}+ ' ' +${assessorAssigned?.lastName} : 'NOT ASSIGNED'"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Division</div>
                                                <div class="list-text-accordion" th:text="${divisionValue}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Section</div>
                                                <div class="list-text-accordion" th:text="${sectionValue}"></div>
                                            </li>
                                            <li th:if="${permitDetails?.inspectionScheduledStatus == 1}" class="list-item-accordion">
                                                <div class="list-title-accordion">Inspection Date</div>
                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.inspectionDate, 'dd/MM/yyyy')}"></div>
                                            </li>
                                            <li th:if="${permitDetails?.assessmentScheduledStatus == 1}" class="list-item-accordion">
                                                <div class="list-title-accordion">Factory Assessment Date</div>
                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.assessmentDate, 'dd/MM/yyyy')}"></div>
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Status</div>
<!--                                                <div class="list-text-accordion" th:text="${#dates.format(permitDetails?.dateOfExpiry, 'dd/MM/yyyy')}"></div>-->
                                            </li>
                                            <li class="list-item-accordion">
                                                <div class="list-title-accordion">Version Number</div>
                                                <div class="list-text-accordion" th:text="${permitDetails?.versionNumber}"></div>
                                            </li>
                                            <li th:if="${permitDetails?.fmarkGenerated == 1}" class="list-item-accordion">
                                                <div class="list-title-accordion">FMARK VIEW</div>
                                                <div class="list-text-accordion"><a class="btn btn-primary itemViewBtn"
                                                                                    target='_blank'
                                                                                    th:href="@{/api/qa/view/fmark-generated(smarkID=${permitDetails.id})}">view</a>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <button class="accordion">Product Details</button>
                            <div class="panel">
                                <ul class="w-list-unstyled">
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Product Standard Category</div>
                                        <div class="list-text-accordion" th:text="${standardCategory?.standardCategory}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Broad Product Category</div>
                                        <div class="list-text-accordion" th:text="${broadProductCategory?.category}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Product Category</div>
                                        <div class="list-text-accordion" th:text="${productCategory?.name}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Product</div>
                                        <div class="list-text-accordion" th:text="${product?.name}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Product Sub-Category</div>
                                        <div class="list-text-accordion" th:text="${productSubCategory?.name}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">KS Number</div>
                                        <div class="list-text-accordion" th:text="${ksApplicable?.standardNumber}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">Title</div>
                                        <div class="list-text-accordion" th:text="${ksApplicable?.standardTitle}"></div>
                                    </li>
                                </ul>
                            </div>

                            <button class="accordion">Plant Attached Details</button>
                            <div class="panel">
                                <ul class="w-list-unstyled">
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">REGION</div>
                                        <div class="list-text-accordion" th:text="${regionPlantValue}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">COUNTY</div>
                                        <div class="list-text-accordion" th:text="${countyPlantValue}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">TOWN</div>
                                        <div class="list-text-accordion" th:text="${townPlantValue}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">LOCATION</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.location}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">STREET</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.street}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">BUILDING_NAME</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.buildingName}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">NEAREST_LAND_MARK</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.nearestLandMark}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">POSTAL_ADDRESS</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.postalAddress}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">TELEPHONE</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.telephone}"></div>
                                    </li>
                                    <li class="list-item-accordion">
                                        <div class="list-title-accordion">CONTACT_PERSON</div>
                                        <div class="list-text-accordion" th:text="${plantAttached?.contactPerson}"></div>
                                    </li>
                                </ul>
                            </div>

                            <button class="accordion" >Documents Attached Details</button>
                            <div class="panel">
                                <div class="row-table ">
                                    <table class="table table-striped">
                                        <thead>
                                        <tr>
                                            <th>File Name</th>
                                            <th>File Type</th>
                                            <th>Document Description</th>
                                            <th>View</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr class="list" th:each="fileParam: ${fileParameters}" style="cursor: pointer">

                                            <td th:text="${fileParam.name}"></td>
                                            <td th:text="${fileParam.fileType}"></td>
                                            <td th:text="${fileParam.documentType}"></td>
                                            <td><a th:href="@{/api/qa/kebs/view/attached(fileID=${fileParam.id})}" target='_blank' class="btn btn-primary itemViewBtn">view</a></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <button class="accordion">Other Version Details</button>
                            <div class="panel">
                                <div class="row-table ">
                                    <table class="table table-striped table-bordered" id="oldVersions"
                                           style="width:100%">
                                        <thead>
                                        <tr>
                                            <th>Permit Number</th>
                                            <th>Version Number</th>
                                            <th>View</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr class="list" style="cursor: pointer"
                                            th:each="olderVersion: ${oldVersionList}">

                                            <td th:text="${olderVersion?.permitNumber}"></td>
                                            <td th:text="${olderVersion?.versionNumber}"></td>
                                            <td><a class="btn btn-primary itemViewBtn" target='_blank'
                                                   th:href="@{/api/qa/permit-details(permitID=${olderVersion.id},userID=${olderVersion?.userId})}">VIEW</a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>


<!--                            <button class="accordion">Item Details</button>-->
<!--                            <div class="panel">-->
<!--                                <div class="row-table ">-->
<!--                                    <table id="example" class="table table-striped table-bordered" style="width:100%">-->
<!--                                        <thead>-->
<!--                                        <tr>-->
<!--                                            <th>Number</th>-->
<!--                                            <th>Description</th>-->
<!--                                            <th>HS Code</th>-->
<!--                                            <th>Quantity</th>-->
<!--                                            <th>Unit Quantity</th>-->
<!--                                            <th>Country Of Origin</th>-->
<!--                                            <th>Inspection Status</th>-->
<!--                                            <th th:if="${cdDetails.localCoi == activeStatus}">Owner Status</th>-->
<!--                                            <th>View</th>-->
<!--                                        </tr>-->
<!--                                        </thead>-->
<!--                                        <tbody>-->
<!--                                        <tr class="list" th:each="itemCD: ${itemsCD}" style="cursor: pointer">-->

<!--                                            <td th:text="${itemCD.itemNo}"></td>-->
<!--                                            <td th:text="${itemCD.itemDescription}"></td>-->
<!--                                            <td th:text="${itemCD.itemHsCode}"></td>-->
<!--                                            <td th:text="${itemCD.quantity}"></td>-->
<!--                                            <td th:text="${itemCD.unitOfQuantity}"></td>-->
<!--                                            <td th:text="${itemCD.countryOfOrgin}"></td>-->
<!--                                            <td style="color: #f30014; font-weight: bold; "-->
<!--                                                th:if="${itemCD?.inspectionNotificationStatus == 1}">YES-->
<!--                                            </td>-->
<!--                                            <td style="color: #20f300; font-weight: bold; "-->
<!--                                                th:unless="${itemCD?.inspectionNotificationStatus == 1}">NO-->
<!--                                            </td>-->
<!--                                            <td style="color: #20f300; font-weight: bold; "-->
<!--                                                th:if="${itemCD?.ownerPin != null and itemCD?.cdDocId?.localCoi == 1}">-->
<!--                                                YES-->
<!--                                            </td>-->
<!--                                            <td style="color: #f30014; font-weight: bold; "-->
<!--                                                th:if="${itemCD?.ownerPin == null and itemCD?.cdDocId?.localCoi == 1}">-->
<!--                                                NO-->
<!--                                            </td>-->
<!--                                            <td><a th:href="@{/api/di/cd-item-details/(cdItemUuid=${itemCD.uuid})}"-->
<!--                                                   class="btn btn-primary itemViewBtn">view</a></td>-->
<!--                                        </tr>-->
<!--                                        </tbody>-->
<!--                                    </table>-->
<!--                                </div>-->
<!--                            </div>-->


                        </div>

                        <div class="filter-block">
                            <div class="filter-block-title">
                                <div class="filter-title">Document Details:</div>
                            </div>
                            <div>
                                <a th:if="${permitType?.st3Status == 1 and permitDetails?.sta3FilledStatus == 1}" target='_blank' th:href="@{/api/qa/view-sta3(permitID=${permitDetails?.id}, userID=${permitDetails?.userId})}" class="filter-link" style="color: white">STA 3</a>
                                <a th:if="${permitType?.st10Status == 1 and permitDetails?.sta10FilledStatus == 1}" target='_blank' th:href="@{/api/qa/view-sta10(permitID=${permitDetails?.id}, userID=${permitDetails?.userId})}" class="filter-link" style="color: white">STA 10</a>
                                <a th:if="${permitDetails?.sendApplication == 1 and permitDetails?.invoiceGenerated == 1}" target='_blank' th:href="@{/api/qa/invoice-details(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">GENERATED INVOICE</a>
                                <a th:if="${permitDetails?.generateSchemeStatus == 1 and permitType?.schemeGenerate == 1}" th:href="@{/api/qa/scheme-of-supervision(permitID=${permitDetails?.id})}" style="color: white" onclick="popUpFunction('generateScheme');" class="filter-link">GENERATE SCHEME FOR SUPERVISION AND CONTROL</a>
                                <div sec:authorize="hasAuthority('QA_ASSESSORS_READ') or hasAuthority('QA_PAC_SECRETARY_READ')">

                                <a th:if="${permitDetails?.generateSchemeStatus == 1 and permitType?.schemeGenerate == 1}" th:href="@{/api/qa/scheme-of-supervision(permitID=${permitDetails?.id})}" style="color: white" class="filter-link">VIEW GENERATED SCHEME FOR SUPERVISION AND CONTROL</a>

                                <div sec:authorize="hasAuthority('QA_ASSESSORS_READ')">
                                    <a th:if="${permitDetails?.assessmentScheduledStatus == 30}" target='_blank' th:href="@{/api/qa/factory-assessment(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">FACTORY ASSESSMENT REPORT</a>
                                </div>
                                <div sec:authorize="hasAuthority('QA_PAC_SECRETARY_READ')">
                                    <a th:if="${permitDetails?.assessmentScheduledStatus == 30}" target='_blank' th:href="@{/api/qa/report/pac_summary(permit_id=${permitDetails?.id})}" class="filter-link" style="color: white">DMARK FACTORY CONFORMITY SUMMARY</a>
                                </div>
                            </div>
                            <div class="filter-block-title">
                                <div class="filter-title">Action:</div>
                            </div>
                            <div>

                                    <a    class="filter-link uploadBtn" style="color: white">UPLOAD ATTACHMENTS</a>

                                <div sec:authorize="hasAuthority('PERMIT_APPLICATION')">
                                    <a th:if="${permitDetails?.attachedPlantId == null}" style="color: white" onclick="popUpFunction('attachePlant');" class="filter-link">ATTACHE PLANT</a>

                                    <a th:if="${permitDetails?.permitExpiredStatus == 1}"  th:href="@{/api/qa/kebs/renew/permit-details/save(permitNo=${permitDetails?.permitNumber})}" class="filter-link" style="color: white">RENEW PERMIT</a>

                                    <a th:if="${permitType?.st3Status == 1 and permitDetails?.sta3FilledStatus == null}"  th:href="@{/api/qa/new-sta3(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">Fill STA 3</a>

                                    <a th:if="${permitType?.st10Status == 1 and permitDetails?.sta10FilledStatus == 0}" target='_blank' th:href="@{/api/qa/view-sta10(permitID=${permitDetails?.id}, userID=${permitDetails?.userId})}" class="filter-link" style="color: white">COMPLETE FILLING STA 10</a>

                                    <a th:if="${permitType?.st10Status == 1 and permitDetails?.sta10FilledStatus == null}"  th:href="@{/api/qa/new-sta10(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">Fill STA 10</a>
                                    <a th:if="${permitType?.smeDeclarationForm == 1 and permitDetails?.smeFormFilledStatus == null}"  th:href="@{/api/qa/new-sme-declaration(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">Fill SME DECLARATION</a>

                                    <a th:if="${permitDetails?.generateSchemeStatus == 1 and permitDetails?.approvedRejectedScheme == null and permitType?.schemeGenerate == 1}" th:href="@{/api/qa/scheme-of-supervision(permitID=${permitDetails?.id})}" style="color: white" class="filter-link">APPROVE/REJECT GENERATED SCHEME FOR SUPERVISION AND CONTROL</a>

                                    <div th:if="${permitType?.st10Status == 1 and permitDetails?.sta10FilledStatus == 1 and permitDetails?.attachedPlantId != null}">
                                        <a th:if="${permitDetails?.sendApplication != 1}"  th:href="@{/api/qa/new-permit-submit(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">SUBMIT APPLICATION</a>
                                    </div>
                                    <div th:if="${permitType?.st3Status == 1 and permitDetails?.sta3FilledStatus == 1 and permitDetails?.attachedPlantId != null}">
                                        <a th:if="${permitDetails?.sendApplication != 1}"  th:href="@{/api/qa/new-permit-submit(permitID=${permitDetails?.id})}" class="filter-link" style="color: white">SUBMIT APPLICATION</a>
                                    </div>

                                </div>

                                <div sec:authorize="hasAuthority('QA_MANAGER_ASSESSORS_MODIFY') or hasAuthority('QA_HOF_READ') or hasAuthority('QA_HOD_READ')">
                                    <a th:if="${permitDetails?.hofQamCompletenessStatus == null}" style="color: white" onclick="popUpFunction('permitCompleteness');" class="filter-link">COMPLETENESS ?</a>
                                    <a th:if="${permitDetails?.hofQamCompletenessStatus == 1 and permitDetails?.assignOfficerStatus == null}" style="color: white" onclick="popUpFunction('assignOfficer');" class="filter-link">Assign Officer</a>
                                </div>

                                <div sec:authorize="hasAuthority('QA_OFFICER_MODIFY') or hasAuthority('QA_HOD_MODIFY')">
                                    <a th:if="${permitDetails?.inspectionScheduledStatus == null}" style="color: white" onclick="popUpFunction('scheduleInspectionDate');" class="filter-link">SCHEDULE INSPECTION</a>
                                    <a th:if="${permitDetails?.generateSchemeStatus == null and permitType?.schemeGenerate == 1}" th:href="@{/api/qa/new-scheme-of-supervision(permitID=${permitDetails?.id})}" style="color: white" class="filter-link">GENERATE SCHEME FOR SUPERVISION AND CONTROL</a>


                                    <a th:if="${permitDetails?.hofQamCompletenessStatus == 1 and permitDetails?.assignOfficerStatus == null}" style="color: white" onclick="popUpFunction('assignOfficer');" class="filter-link">Assign Officer</a>
                                    <a th:if="${permitDetails?.compliantStatus == 1}" th:href="@{/api/qa/product-quality-status(permitID=${permitDetails?.id})}" style="color: white" class="filter-link">Justification for Diamond Mark Assessment</a>
                                    <a th:if="${permitDetails?.justificationReportStatus == 1 and permitDetails?.assignAssessorStatus == null}" style="color: white" onclick="popUpFunction('assignAssessor');" class="filter-link">Assign Assessor</a>
                                </div>

                                <div sec:authorize="hasAuthority('QA_ASSESSORS_MODIFY')">
                                    <a th:if="${permitDetails?.assessmentScheduledStatus == null}" style="color: white" onclick="popUpFunction('scheduleAssessmentDate');" class="filter-link">SCHEDULE ASSESSMENT</a>
                                    <a th:if="${permitDetails?.assessmentScheduledStatus == 1}" class="filter-link uploadAssessmentReportBtn" style="color: white">UPLOAD ASSESSMENT REPORT</a>
                                </div>

                                <div sec:authorize="hasAuthority('QA_PAC_SECRETARY_MODIFY')">
                                    <a th:if="${permitDetails?.assessmentScheduledStatus == 30}" style="color: white" onclick="popUpFunction('dmarkApplicationApproval');" class="filter-link">Grant/Defer Application</a>
                                </div>

                            </div>

                        </div>

                        <!--                        <div sec:authorize="hasAuthority('DI_OFFICER_CHARGE_READ')" th:if="${userNumber == 0}"class="filter-block">-->
                        <!--                            <div class="filter-block-title">-->
                        <!--                                <div class="filter-title">Actions:</div>-->
                        <!--                            </div>-->
                        <!--                            <div th:if="${session?.docView == 'importerAgent'}">-->
                        <!--                                <a  th:if="${cdDetails?.blacklistApproved != 1}" style="color: white" class="filter-link blacklistApproveBtn">Approve</a>-->
                        <!--                                <a th:if="${cdDetails?.blacklistRejected != 1}" style="font-weight: bold;" class="filter-link bgred blacklistRejectBtn">Reject</a>-->
                        <!--                            </div>-->

                        <!--                            <div th:if="${session?.docView == 'targeting'}">-->
                        <!--                                <a th:if="${cdDetails?.targetApproved != 1}" style="color: white" class="filter-link targetingApproveBtn">Approve</a>-->
                        <!--                                <a th:if="${cdDetails?.targetingRejected != 1}" style="font-weight: bold;" class="filter-link bgred targetingRejectBtn">Reject</a>-->
                        <!--                            </div>-->

                        <!--                            <div th:if="${session?.docView == 'cocDetails'}">-->
                        <!--                                <a th:if="${cdDetails?.assignedStatus != 1}"  style="color: white" class="filter-link assignBtn">Assign Officer</a>-->
                        <!--                                <a th:if="${cdDetails?.assignedStatus == 1}" style="color: white" class="filter-link assignBtn">Re-assign Officer</a>-->
                        <!--                                <a  style="color: white" class="filter-link addRemarksBtn">Add Remarks</a>-->
                        <!--                                <a  style="color: white" class="filter-link approveBtn">Approve</a>-->
                        <!--                                <a th:if="${cdDetails?.rejectedStatus != 1}" style="font-weight: bold;" class="filter-link bgred rejectBtn">Reject</a>-->
                        <!--                                <a th:if="${cdDetails?.targetApproved != 1}" style="font-weight: bold;" class="filter-link bgred targetBtn">Target Inspection</a>-->
                        <!--                                <a  th:if="${cdDetails?.blacklistStatus != 1}" style="font-weight: bold;" class="filter-link bgred blacklistBtn">Blacklist</a>-->
                        <!--                            </div>-->
                        <!--                            <div class="filter-block-title">-->
                        <!--                                <div class="filter-title">Document Details:</div>-->
                        <!--                            </div>-->
                        <!--                            <div>-->
                        <!--                                <a th:href="@{/api/di/documents-view/(doc = 'coc',certBack = 'cocDetails')}" class="filter-link cocBtn">Certificate of compliance</a>-->
                        <!--                                <a th:href="@{/api/di/documents-view/(doc = 'remarks',certBack = 'cocDetails')}" class="filter-link cocBtn">View Remarks</a>-->
                        <!--                                <a th:href="@{/api/di/documents-view/(doc = 'idf',certBack = 'cocDetails')}" class="filter-link cocBtn">IDF Document</a>-->
                        <!--&lt;!&ndash;                                <a th:href="@{/api/di/manifest-view/{certBack}(certBack = 'cocDetailsSupervisor')}" class="filter-link cocBtn">Manifest Document</a>&ndash;&gt;-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                    </div>
                </div>
            </div>

            <div  class="qaApplicationForm">
                <form id="qa-application-form"   name="qa-application-form" th:action="@{/api/qa/apply/update-permit(permitID=${permitDetails.id})}" method="post" th:object="${permitDetails}">
                    <div class="modal fade" id="qaApplicationModal" tabindex="-1" role="dialog" aria-labelledby="qaApplicationModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 style="font-weight: bold; " class="modal-title" id="qaApplicationModalLabel"><span id="spanValue" >none</span></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <div id="attachePlant">
                                            <input type="hidden" id="description" name="description" th:value="'Plant attached sucessfull'">
                                            <label for="attachedPlantId" class="col-form-label">Select a Plant:</label>
                                            <select id="attachedPlantId" required class="select-field w-select" th:field="*{attachedPlantId}">
                                                <option value="0">Select one...</option>
                                                <option  th:each="plant : ${plantsDetails}" th:text="${plant?.buildingName}" th:name="attachedPlantId" th:value="${plant?.id}"></option>
                                            </select>
                                            <label for="attachedPlantRemarks" class="col-form-label">Please write, in detail, your feedback for attaching the Plant above:</label>
                                            <textarea required name="name" id="attachedPlantRemarks" class="input-field w-input" cols="65" rows="5" th:field="*{attachedPlantRemarks}"></textarea>
                                        </div>

                                        <div id="permitCompleteness">
                                            <input type="hidden" id="description2" name="description" th:value="'Permit Is Complete,Please Assign The next Officer'">
                                            <input type="hidden" id="varField1" name="varField1" th:value="'Permit Is Incomplete'">
                                            <label for="attachedPlantId" class="col-form-label">Select a completeness status:</label>
                                            <select id="hofQamCompletenessStatus" required class="select-field w-select" th:field="*{hofQamCompletenessStatus}">
                                                <option th:text="'Select one.....'" th:value="null"></option>
                                                <option th:text="'Yes'" th:value="1"></option>
                                                <option th:text="'No'" th:value="0"></option>
                                            </select>
                                            <label for="hofQamCompletenessRemarks" class="col-form-label">Please write, in detail, your feedback for this Permit:</label>
                                            <textarea required name="name" id="hofQamCompletenessRemarks" class="input-field w-input" cols="65" rows="5" th:field="*{hofQamCompletenessRemarks}"></textarea>
                                        </div>

                                        <div id="assignOfficer">
                                            <input type="hidden" id="description3" name="description" th:value="'Officer Assigned sucessfull'">
                                            <input type="hidden" id="assignOfficerStatus" name="assignOfficerStatus" th:value="${activeStatus}">
                                            <label for="qaoId" class="col-form-label">Select Officer:</label>
                                            <select id="qaoId" required class="select-field w-select" th:field="*{qaoId}">
                                                <option value="0">Select one...</option>
                                                <option th:each="officer : ${officers}" th:text="${officer.userId?.firstName} + ' ' + ${officer.userId?.lastName}" th:name="qaoId" th:value="${officer.userId?.id}"></option>
                                            </select>
<!--                                            <label for="hofQamCompletenessRemarks" class="col-form-label">Please write, in detail, your feedback for this Permit:</label>-->
<!--                                            <textarea required name="name" id="hofQamCompletenessRemarks" class="input-field w-input" cols="65" rows="5" th:field="*{hofQamCompletenessRemarks}"></textarea>-->
                                        </div>
                                        <div id="scheduleInspectionDate">
                                            <input type="hidden" id="description4" name="description" th:value="'Inspection Date set sucessfull'">
                                            <input type="hidden" id="inspectionScheduledStatus" name="inspectionScheduledStatus" th:value="${activeStatus}">
                                            <label for="qaoId" class="col-form-label">Inspection Date:</label>
                                            <input class="input-field w-input" type="date" max="20" id="inspectionDate" name="inspectionDate" th:required="required">
<!--                                            <select id="qaoId" required class="select-field w-select" th:field="*{qaoId}">-->
<!--                                                <option value="0">Select one...</option>-->
<!--                                                <option th:each="officer : ${officers}" th:text="${officer.userId?.firstName} + ' ' + ${officer.userId?.lastName}" th:name="qaoId" th:value="${officer.userId?.id}"></option>-->
<!--                                            </select>-->
<!--                                            <label for="hofQamCompletenessRemarks" class="col-form-label">Please write, in detail, your feedback for this Permit:</label>-->
<!--                                            <textarea required name="name" id="hofQamCompletenessRemarks" class="input-field w-input" cols="65" rows="5" th:field="*{hofQamCompletenessRemarks}"></textarea>-->
                                        </div>
                                        <div id="assignAssessor">
                                            <input type="hidden" id="description5" name="description" th:value="'Assessor successfully assigned'">
                                            <input type="hidden" id="assignAssessorStatus" name="assignAssessorStatus" th:value="${activeStatus}">
                                            <label for="assessorId" class="col-form-label">Select Officer:</label>
                                            <select id="assessorId" required class="select-field w-select" th:field="*{assessorId}">
                                                <option value="0">Select one...</option>
                                                <option th:each="assessor : ${assessors}" th:text="${assessor.userId?.firstName} + ' ' + ${assessor.userId?.lastName}" th:name="assessorId" th:value="${assessor.userId?.id}"></option>
                                            </select>
                                        </div>
                                        <div id="scheduleAssessmentDate">
                                            <input type="hidden" id="description6" name="description" th:value="'Factory assessment date successfully created'">
                                            <input type="hidden" id="assessmentScheduledStatus" name="assessmentScheduledStatus" th:value="${activeStatus}">
                                            <label for="qaoId" class="col-form-label">Assessment Date:</label>
                                            <input class="input-field w-input" type="date" max="20" id="assessmentDate" name="assessmentDate" th:required="required">
                                            <label for="assessmentCriteria" class="col-form-label">Please write, in detail, the assessment criteria for the visit:</label>
                                            <textarea required name="assessmentCriteria" id="assessmentCriteria" class="input-field w-input" cols="65" rows="5" th:field="*{assessmentCriteria}"></textarea>
                                        </div>
                                        <div id="dmarkApplicationApproval">
                                            <input type="hidden" id="description7" name="description" th:value="'Permit status successfully updated'">
                                            <label for="attachedPlantId" class="col-form-label">Select application status:</label>
                                            <select id="permitAwardStatus" required class="select-field w-select" th:field="*{permitAwardStatus}">
                                                <option th:text="'Select one.....'" th:value="null"></option>
                                                <option th:text="'Grant'" th:value="1"></option>
                                                <option th:text="'Deffer'" th:value="0"></option>
                                            </select>
                                            <label for="hofQamCompletenessRemarks" class="col-form-label">Please write, in detail, PAC decision/remarks:</label>
                                            <textarea required name="name" id="pacDecisionRemarks" class="input-field w-input" cols="65" rows="5" th:field="*{pacDecisionRemarks}"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-dismiss="modal" onClick="refreshPage()" type="button">Close</button>
                                    <input type="submit" id="saveValue" class="btn btn-primary" value="Save"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div class="uploadForm">
                <form id="upload-form" enctype="multipart/form-data"  name="upload-form" th:action="@{/api/qa/kebs/add/new-upload(permitID = ${permitDetails?.id})}" method="post" >
                    <div class="modal fade" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 style="font-weight: bold; " class="modal-title" id="uploadModalLabel"><span id="uploadSpan-1" >none</span></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label for="docFileName" class="col-form-label">Description Of Attachment(s):</label>
                                        <input class="input-field w-input"  max="20" id="docFileName" name="docFileName" th:required="required">
                                        <label for="doc_file">Upload your Attachments</label>
                                        <input type="file" class="form-control"  multiple name="doc_file" data-name="doc_file" id="doc_file" required="required" >
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-dismiss="modal" onClick="refreshPage()" type="button">Close</button>
                                    <input type="submit" id="upload-1" class="btn btn-primary" value="Save"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div class="uploadAssessmentReportForm">
                <form id="upload-assessment-form" enctype="multipart/form-data"  name="upload-form" th:action="@{/api/qa/factory-assessment-report(permitID = ${permitDetails?.id})}" method="post" >
                    <div class="modal fade" id="uploadAssessmentModal" tabindex="-1" role="dialog" aria-labelledby="uploadAssessmentModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 style="font-weight: bold; " class="modal-title" id="uploadAssessmentModalLabel"><span id="uploadSpan-2" >none</span></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <input type="hidden" id="docFileName" name="docFileName" th:value="FACTORY_ASSESSMENT_REPORT">
                                        <label for="doc_file">Upload The Factory Assessment Report</label>
                                        <input type="file" class="form-control"  multiple name="doc_file" data-name="doc_file" id="doc_file" required="required" >
                                    </div>
                                    <div class="form-group">
                                        <label for="assessment_recommendations" class="col-form-label">Please write, in detail, your recommendations:</label>
                                        <textarea required name="assessment_recommendations" id="assessment_recommendations" class="input-field w-input" cols="65" rows="5"></textarea>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-dismiss="modal" onClick="refreshPage()" type="button">Close</button>
                                    <input type="submit" id="upload-2" class="btn btn-primary" value="Save"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script th:src="@{/assets/bootstrap3/js/bootstrap.js}" type="text/javascript"></script>
<script src="../assets/js/webflow.js" type="text/javascript"></script>

<!-- [if lte IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
<script th:src="@{/js/spinner.js}" type="text/javascript"></script>

<script>
    document.onreadystatechange = function () {
        showSpinnerOnLoad(document)
    }

    function loadSpinner() {
        showSpinner(document)
    }
</script>
<script>
    var acc = document.getElementsByClassName("accordion");
    // var btn = document.getElementsByClassName("button w-button eBtn");
    var i;

    for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function () {
            this.classList.toggle("active");
            this.style.border = "none";
            // this.style.position = "sticky"
            var panel = this.nextElementSibling;
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
            } else {
                panel.style.maxHeight = panel.scrollHeight + "px";
                // panel.style.position = "-webkit-sticky"
                // panel.style.position = "sticky"
            }
        });
    }


</script>
<script>
    $(document).ready(function () {
        var table = $('#example').DataTable({
            lengthChange: false,
            buttons: ['copy', 'excel', 'pdf', 'colvis']
        });

        table.buttons().container()
            .appendTo('#example_wrapper .col-sm-6:eq(0)');
    });
</script>
<script>
    $(document).ready(function () {
        $('.filter-block .uploadBtn').on('click', function (event) {
            document.getElementById('uploadSpan-1').innerHTML = 'Upload document And Give The Name'
            document.getElementById("upload-1").value = "submit";
            $('.uploadForm #uploadModal').modal();
        });

        $('.filter-block .uploadAssessmentReportBtn').on('click', function (event) {
            document.getElementById('uploadSpan-2').innerHTML = 'Upload factory assessment report'
            document.getElementById("upload-2").value = "submit";
            $('.uploadAssessmentReportForm #uploadAssessmentModal').modal();
        });

        $("#portOfArrival").click(function () {
            let sectionId = $("#portOfArrival").val()
            // console.log(categories.length)
            if (sectionId !== 0) {
                $.ajax({
                    method: "GET",
                    url: `/api/auth/sub-section-l1-list/${sectionId}`,
                    success(response) {
                        console.log(response)
                        var s = ''
                        s += ' <option value="0">Select One...</option>';
                        for (var i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].subSection + '</option>';
                        }
                        $("#clusterId").html(s);
                    }
                })
            }

        });

        $("#clusterId").click(function () {
            let subSectionL1Id = $("#clusterId").val()
            // console.log(categories.length)
            if (subSectionL1Id !== 0) {
                $.ajax({
                    method: "GET",
                    url: `/api/auth/sub-section-l2-list/${subSectionL1Id}`,
                    success(response) {
                        console.log(response)
                        let s = '';
                        s += ' <option value="0">Select One...</option>';
                        for (let i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].subSection + '</option>';
                        }
                        $("#freightStation").html(s);
                    }
                })
            }

        });
    });
</script>
<script>
    function popUpFunction(eventAction) {
        let arrHead = [ 'attachePlant', 'permitCompleteness', 'assignOfficer', 'scheduleInspectionDate', 'assignAssessor', 'scheduleAssessmentDate', 'dmarkApplicationApproval'];
        let arrHeadSave = [ 'Attach a Plant for manufacturing the product', 'Is The Permit Complete', 'Select An officer',' Set The Date of Inspection', 'Select An Assessor', 'Schedule Factory Assessment Date',
        'Grant/Defer Application'];

        for (let h = 0; h < arrHead.length; h++) {
            if(eventAction !== arrHead[h]){
                document.getElementById(arrHead[h]).remove();
            }else {
                if (eventAction === arrHead[h]) {
                    document.getElementById('spanValue').innerHTML = arrHeadSave[h];
                    document.getElementById("saveValue").value = 'Save';
                }
            }
        }

        $('.qaApplicationForm #qaApplicationModal').modal();
    }

    function refreshPage() {
        window.location.reload();
    }
</script>
</body>
</html>


