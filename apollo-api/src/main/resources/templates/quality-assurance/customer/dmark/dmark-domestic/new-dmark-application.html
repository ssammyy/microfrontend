<!--
  ~
  ~ $$$$$$$\   $$$$$$\  $$\   $$\        $$$$$$\  $$\       $$$$$$\  $$$$$$$\   $$$$$$\  $$\
  ~ $$  __$$\ $$  __$$\ $$ | $$  |      $$  __$$\ $$ |     $$  __$$\ $$  __$$\ $$  __$$\ $$ |
  ~ $$ |  $$ |$$ /  \__|$$ |$$  /       $$ /  \__|$$ |     $$ /  $$ |$$ |  $$ |$$ /  $$ |$$ |
  ~ $$$$$$$\ |\$$$$$\  $$$$$  /        $$ |$$$$\ $$ |     $$ |  $$ |$$$$$$$\ |$$$$$$$$ |$$ |
  ~ $$  __$$\  \____$$\ $$  $$<         $$ |\_$$ |$$ |     $$ |  $$ |$$  __$$\ $$  __$$ |$$ |
  ~ $$ |  $$ |$$\   $$ |$$ |\$\        $$ |  $$ |$$ |     $$ |  $$ |$$ |  $$ |$$ |  $$ |$$ |
  ~ $$$$$$$  |\$$$$$  |$$ | \$\       \$$$$$  |$$$$$$$$\ $$$$$$  |$$$$$$$  |$$ |  $$ |$$$$$$$$\
  ~ \_______/  \______/ \__|  \__|       \______/ \________|\______/ \_______/ \__|  \__|\________|
  ~ $$$$$$$$\ $$$$$$$$\  $$$$$$\  $$\   $$\ $$\   $$\  $$$$$$\  $$\       $$$$$$\   $$$$$$\  $$$$$$\ $$$$$$$$\  $$$$$$\
  ~ \__$$  __|$$  _____|$$  __$$\ $$ |  $$ |$$$\  $$ |$$  __$$\ $$ |     $$  __$$\ $$  __$$\ \_$$  _|$$  _____|$$  __$$\
  ~    $$ |   $$ |      $$ /  \__|$$ |  $$ |$$$$\ $$ |$$ /  $$ |$$ |     $$ /  $$ |$$ /  \__|  $$ |  $$ |      $$ /  \__|
  ~    $$ |   $$$$$\    $$ |      $$$$$$$$ |$$ $$\$ |$$ |  $$ |$$ |     $$ |  $$ |$$ |$$$$\   $$ |  $$$$$\    \$$$$$\
  ~    $$ |   $$  __|   $$ |      $$  __$$ |$$ \$$$ |$$ |  $$ |$$ |     $$ |  $$ |$$ |\_$$ |  $$ |  $$  __|    \____$$\
  ~    $$ |   $$ |      $$ |  $$\ $$ |  $$ |$$ |\$$ |$$ |  $$ |$$ |     $$ |  $$ |$$ |  $$ |  $$ |  $$ |      $$\   $$ |
  ~    $$ |   $$$$$$$$\ \$$$$$  |$$ |  $$ |$$ | \$ | $$$$$$  |$$$$$$$$\ $$$$$$  |\$$$$$  |$$$$$$\ $$$$$$$$\ \$$$$$  |
  ~    \__|   \________| \______/ \__|  \__|\__|  \__| \______/ \________|\______/  \______/ \______|\________| \______/
  ~
  ~
  ~
  ~
  ~
  ~   Copyright (c) 2020.  BSK
  ~   Licensed under the Apache License, Version 2.0 (the "License");
  ~   you may not use this file except in compliance with the License.
  ~   You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~   Unless required by applicable law or agreed to in writing, software
  ~   distributed under the License is distributed on an "AS IS" BASIS,
  ~   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~   See the License for the specific language governing permissions and
  ~   limitations under the License.
  -->


<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Mar 18 2020 20:03:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e70fb3a565ebdc05ddb37cf" data-wf-site="5e70fb3a565ebd99c1db37ce"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>KEBS | New DMARK Application</title>
    <th:block th:include="fragments/general-form.html :: headerfiles"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/accordion.css}"/>
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <style>
        body {
            font-family: sans-serif;
        }
        a {
            color: #369;
        }
        .note {
            width: 500px;
            margin: 50px auto;
            font-size: 1.1em;
            color: #333;
            text-align: justify;
        }
        #drop-area {
            border: 2px dashed #ccc;
            border-radius: 20px;
            width: 480px;
            margin: 50px auto;
            padding: 20px;
        }
        #drop-area.highlight {
            border-color: purple;
        }
        p {
            margin-top: 0;
        }
        .my-form {
            margin-bottom: 10px;
        }
        #gallery {
            margin-top: 10px;
        }
        #gallery img {
            width: 150px;
            margin-bottom: 10px;
            margin-right: 10px;
            vertical-align: middle;
        }
        .button {
            display: inline-block;
            padding: 10px;
            background: #ccc;
            cursor: pointer;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .button:hover {
            background: #ddd;
        }
        #fileElem {
            display: none;
        }
    </style>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            background-color: #f1f1f1;
        }
        #regForm {
            background-color: #ffffff;
            margin: 20px auto;
            font-family: Raleway;
            padding: 5px;
            width: 70%;
            min-width: 300px;
        }
        h1 {
            text-align: center;
        }
        input {
            padding: 10px;
            width: 100%;
            font-size: 17px;
            font-family: Raleway;
            border: 1px solid #aaaaaa;
        }
        /* Mark input boxes that gets an error on validation: */
        input.invalid {
            background-color: #ffdddd;
        }
        /* Hide all steps by default: */
        .tab {
            display: none;
        }
        button {
            background-color: #4CAF50;
            color: #ffffff;
            border: none;
            padding: 10px 20px;
            font-size: 17px;
            font-family: Raleway;
            cursor: pointer;
        }
        button:hover {
            opacity: 0.8;
        }
        #prevBtn {
            background-color: #bbbbbb;
        }
        /* Make circles that indicate the steps of the form: */
        .step {
            height: 15px;
            width: 15px;
            margin: 0 2px;
            background-color: #bbbbbb;
            border: none;
            border-radius: 50%;
            display: inline-block;
            opacity: 0.5;
        }
        .step.active {
            opacity: 1;
        }
        /* Mark the steps that are finished and valid: */
        .step.finish {
            background-color: #4CAF50;
        }
    </style>
</head>
<body>
<div class="top-bar" th:replace="fragments/general-form.html :: top-bar">

</div>
<div class="section">
    <div class="w-layout-grid main-grid">
        <div class="main-grid-side-navigation" id="w-node-d308c123a20f-c123a20d" th:replace="fragments/general-form.html :: side-navigation-bar"></div>
        <div id="w-node-a58aeb4cd9dd-b7f94a3d" class="main-content-div">
<!--            <div class="content-nav" th:replace="fragments/general-form.html :: content-navigation-bar"></div>-->
<!--            <div class="content-nav">-->
<!--                <div class="content-title">KIMS Platform</div>-->
<!--                <a class="content-nav-link" href="#"><span class="font-awesome-span">th</span>Dashboard</a><a class="content-nav-link" href="#"><span class="font-awesome-span"></span>Quality Assurance</a><a class="content-nav-link" href="#"><span class="font-awesome-span"></span><span th:text="${title}"></span></a>-->
<!--            </div>-->
            <div class="content-nav" th:replace="fragments/general-form.html :: content-navigation-bar"></div>
            <div class="content-wrap">
                <div class="content-row">
                    <div class="form-nav">
                        <a href="#" aria-current="page" class="link-block-2 w-inline-block w--current">
                            <div class="text-block-4"><span class="text-span">1</span>Permit application</div>
                        </a>
                        <a href="#" aria-current="page" class="link-block-2 w-inline-block w--current">
                            <div class="text-block-4"><span class="text-span">1</span>Questionnaire</div>
                        </a>

                    </div>
                    <h1>DMARK Application Form<span></span></h1>
                    <div>
<!--                        <h5>Kindly fill in the details below</h5>-->
                        <div class="content-row">
                            <div th:replace="fragments/general-form.html :: alerts-bar"></div>
                            <form id="regForm"  name="smark-form" enctype="multipart/form-data" data-name="S Mark Form" th:object="${dmark}" th:action="@{/dmark/apply(pTypeId = 1, appId=150, fDomestic=${fDomestic})}" method="post" >

<!--                                Foreign applicant details-->
                                <div th:if="${fDomestic == 'Foreign'}">
                                    <h4>Manufacturer details</h4>
                                    <div><label for="companyName" class="field-label">Manufacturer Company Name</label><input type="text"  class="w-input" maxlength="256" name="total-number" data-name="total number" id="companyName"  th:field="*{manufacturerCompanyName}"></div>
                                    <div><label for="emailAddress" class="field-label">Company Email Address</label><input type="email"  class="w-input" maxlength="256" name="total-number" data-name="total number" id="emailAddress" th:field="*{email}"></div>
                                    <div><label for="companyRepresentative" class="field-label">Company Representative Name</label><input type="text"  class="w-input" maxlength="256" name="total-number" data-name="total number" id="companyRepresentative"  th:field="*{companyRepresentative}"></div>
                                    <div><label for="companyRepresentative" class="field-label">Company Representative Email</label><input type="text"  class="w-input" maxlength="256" name="total-number" data-name="total number" id="companyRepresentativeEmail"  th:field="*{companyRepresentativeEmail}"></div>
                                    <br>
                                    <h4>Physical Address</h4>
                                    <div>
                                        <label for="streetAddress" class="field-label">Street address</label>
                                        <input type="text"  class="w-input" placeholder="Street and number, P.O. box, c/o" maxlength="256" name="streetAddress" data-name="total number" id="streetAddress"  th:field="*{streetAddress}">
                                    </div>
                                    <div>
                                        <label for="building" class="field-label">Building</label>
                                        <input type="text" placeholder="Apartment, suite, unit, building, floor, etc."  class="w-input" maxlength="256" name="building" data-name="total number" id="building"  th:field="*{building}">
                                    </div>
                                    <div>
                                        <label for="city" class="field-label">City</label>
                                        <input type="text" placeholder="City"  class="w-input" maxlength="256" name="city" data-name="total number" id="city"  th:field="*{city}">
                                    </div>
                                    <div>
                                        <label for="state" class="field-label">State/ Region/ Province</label>
                                        <input type="text" placeholder="State"  class="w-input" maxlength="256" name="state" data-name="total number" id="state"  th:field="*{state}">
                                    </div>
                                    <div>
                                        <label for="zipCode" class="field-label">Zip code</label>
                                        <input type="text" placeholder="Zip code"  class="w-input" maxlength="256" name="zipCode" data-name="total number" id="zipCode"  th:field="*{zipCode}">
                                    </div>
                                    <div>
                                        <label for="country" class="field-label">Country</label>
                                        <select  id="country" th:field="*{country}" class="w-input">
                                            <option value="">Select one...</option>
                                            <option  th:each="i : ${session.countries}" th:value="${i.country}" th:text="${i.country}"></option>
                                        </select>
                                    </div>
                                    <br>

                                </div>


                                <div><label for="divisionId" class="field-label">Division</label>
                                    <select reqiured="" id="divisionId" th:field="*{productCategory}" class="w-input">
                                        <option value="">Select one...</option>
                                        <option  th:each="category : ${session.productCategories}" th:value="${category.id}" th:text="${category.standardCategory}"></option>
                                    </select>
                                    <input type="hidden" id="sth" th:value="${session.broadProductCategories}">
                                </div>

                                <!--                                PRODUCT CATEGORIES-->
                                <div><label for="broadCat" class="field-label">Broad Product Category</label>
                                    <select reqiured="" id="broadCat" th:field="*{broadProductCategory}" class="w-input">
                                        <option value="">Select one...</option>
                                    </select>
                                    <!--                                    <input type="text" list="broadCategory" class="w-input" maxlength="256" name="female" data-name="Female" id="broadCat" required="" th:field="*{broadProductCategory}">-->
                                </div>
                                <div><label for="productCategories" class="field-label">Product Category</label>
                                    <select reqiured="" id="productCategories" th:field="*{kebsProductCategory}" class="w-input">
                                        <option value="">Select one...</option>
                                        <!--                                        <option value="">Select one...</option>-->
                                        <!--                                        <option  th:each="product : ${session.products}" th:value="${product.id}" th:text="${product.category}"></option>-->
                                    </select>
                                    <!--                                    <input type="text" list="prods" class="w-input" maxlength="256" name="female" data-name="Female" id="product" required="" th:field="*{product}">-->
                                </div>

                                <!--                                PRODUCT-->
                                <div><label for="product" class="field-label">Product</label>
                                    <select reqiured="" id="product" th:field="*{product}" class="w-input">
                                        <option value="">Select one...</option>
                                    </select>
                                </div>

                                <!--                                SUB CATEGORIES-->
                                <div><label for="subc" class="field-label">Product Sub-Category</label>
                                    <select reqiured="" id="subc" th:field="*{productSubCategory}" class="w-input">
                                        <option value="">Select one...</option>
                                    </select>
                                </div>


                                <div>
                                    <label for="trademark" class="field-label">TradeMark/Brand Name</label>
                                        <input type="text" class="w-input" maxlength="256" name="male" data-name="Male" id="trademark" required="" th:field="*{tradeMark}">
                                </div>
                                <div><label for="permitType" class="field-label"></label><input type="hidden" class="w-input" maxlength="256" name="permitType" data-name="Male" id="permitType" required="" th:value="${ptype}"></div>
                                <div>
                                    <label for="siteApplicable" class="field-label">Site applicable</label>
                                    <input type="text" class="w-input" maxlength="256" name="siteApplicable" data-name="Male" id="siteApplicable" th:field="*{siteApplicable}"  required="">
                                </div>

                                <div>
                                    <label for="noOfSitesProducingTheBrand" class="field-label">No. of sites producing the brand</label>
                                    <input type="number" class="w-input" min="1" maxlength="256" name="male" data-name="Male" id="noOfSitesProducingTheBrand"  th:field="*{noOfSitesProducingTheBrand}">
                                </div>

                                <h4>Upload any other relevant documents</h4>
                                <div id="drop-area">
                                    <div class="my-form">
                                        <p>
                                            Upload multiple files with the file dialog or by dragging and dropping
                                            images onto the dashed region
                                        </p>
                                        <input
                                                type="file"
                                                id="fileElem"
                                                multiple
                                                name="fileElem"
                                                onchange="handleFiles(this.files)"
                                        />
                                        <!-- accept="image/*" -->
                                        <label class="button" for="fileElem">Select some files</label>
                                    </div>
                                    <progress id="progress-bar" max="100" value="0"></progress>
                                </div>
                                <h4>Were the lab tests done at KEBS or at another credited facility?</h4>
                                <select name="" id="selectWhetherTestsWerwDoneAtKebs">
                                    <option selected th:text="Select" th:value="0"></option>
                                    <option th:text="KEBS" th:value="1"></option>
                                    <option th:text="Another" th:value="2"></option>
                                </select>
                                <div id="fileUploadDiv" style="display: none">
                                    <h2>Previous laboratory tests</h2>
                                    <h4>Attach past lab reports received within the last 12 months, if they were not done at KEBS</h4>
                                    <small>Select all files applicable at once</small>
                                    <div><label for="file1" class="field-label"></label><input type="file" multiple="multiple" class="w-input" maxlength="256" name="file1" data-name="Employment Date" id="file1" ></div>
                                </div>
<!--                                accept="image/x-png,image/jpeg,image/jpg"-->



                                <input type="submit" value="Next" data-wait="Please wait..." class="w-button"></form>
                            <div th:if="${message}">
                                <h2 th:text="${message}"></h2>
                            </div>
                            <div class="w-form-done">
                                <div>Thank you! Your submission has been received!</div>
                            </div>
                            <div class="w-form-fail">
                                <div>Oops! Something went wrong while submitting the form.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script th:src="@{/js/webflow.js}" type="text/javascript"></script>
<!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js" type="javascript"></script>
<script>
    $(document).ready(function() {
            $("#selectWhetherTestsWerwDoneAtKebs").click(function () {
                let methodId = $("#selectWhetherTestsWerwDoneAtKebs").children("option:selected").val()
                if (methodId == 2) {
                    // alert(methodId)
                    $("#fileUploadDiv").css("display", "block")
                    // $("#dataRowBank").css("display","none")
                }
                if(methodId == 1){
                    // alert(methodId)
                    $("#fileUploadDiv").css("display", "none")
                    // $("#dataRowBank").css("display","block")
                }

                console.log(methodId)
            });
        }

    )
</script>
<script>
    $(document).ready(function() {
            $("#divisionId").click(function () {
                let methodId = $("#divisionId").children("option:selected").val()
                // let categories = $("#sth").val()
                // console.log(categories.length)
                $.ajax({
                    method: "GET",
                    url: `/populate-broad-category/${methodId}`,
                    data: methodId,
                    success(response){
                        console.log(response)
                        let s = '';
                        for(let i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].category + '</option>';
                        }
                        $("#broadCat").html(s);
                    }
                })
            });

            $("#broadCat").click(function () {
                let methodId2 = $("#broadCat").children("option:selected").val()
                // let categories = $("#sth").val()
                // console.log(categories.length)
                $.ajax({
                    method: "GET",
                    url: `/populate-product-category/${methodId2}`,
                    data: methodId2,
                    success(response){
                        console.log(response)
                        var s = '';
                        for(var i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].name + '</option>';
                        }
                        $("#productCategories").html(s);
                    }
                })

            });

            $("#productCategories").click(function () {
                let methodId3 = $("#productCategories").children("option:selected").val()
                // let categories = $("#sth").val()
                // console.log(categories.length)
                $.ajax({
                    method: "GET",
                    url: `/populate-product-categories/${methodId3}`,
                    data: methodId3,
                    success(response){
                        console.log(response)
                        var s = '';
                        for(var i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].name + '</option>';
                        }
                        $("#product").html(s);
                    }
                })

            });

            $("#product").click(function () {
                let methodId4 = $("#product").children("option:selected").val()
                // let categories = $("#sth").val()
                // console.log(categories.length)
                $.ajax({
                    method: "GET",
                    url: `/populate-sub-category/${methodId4}`,
                    data: methodId4,
                    success(response){
                        console.log(response)
                        let s = '';
                        for(let i = 0; i < response.length; i++) {
                            // response.push('Select one')
                            s += '<option value="' + response[i].id + '">' + response[i].name + '</option>';
                        }
                        $("#subc").html(s);
                    }
                })

            });

            $("#subc").click(function () {
                let methodId5 = $("#subc").children("option:selected").val()
                $.ajax({
                    method: "GET",
                    url: `/populate-standards/${methodId5}`,
                    data: methodId5,
                    success(response){
                        console.log(response)
                        let s = '';
                        for(let i = 0; i < response.length; i++) {
                            s += '<option value="' + response[i].id + '">' + response[i].standardNumber + '</option>';
                        }
                        $("#ksNumber").html(s);
                    }
                })

            });

            // $("#subc").click(function () {
            //     let methodId6 = $("#subc").children("option:selected").val()
            //     $.ajax({
            //         method: "GET",
            //         url: `http://localhost:8005/populate-standards/${methodId6}`,
            //         data: methodId6,
            //         success(response){
            //             console.log(response)
            //             let s = '';
            //             for(let i = 0; i < response.length; i++) {
            //                 s += '<option value="' + response[i].standardTitle + '">' + response[i].standardTitle + '</option>';
            //             }
            //             $("#standardTitle").html(s);
            //         }
            //     })
            //
            // });

            // $("#product").click(function () {
            //     let methodId3 = $("#product").children("option:selected").val()
            //     // let categories = $("#sth").val()
            //     // console.log(categories.length)
            //     $.ajax({
            //         method: "GET",
            //         url: `http://localhost:8005/populate-sub-category/${methodId3}`,
            //         data: methodId4,
            //         success(methodId4){
            //             console.log(methodId4)
            //             var s = '';
            //             // for(var i = 0; i < response.length; i++) {
            //             s += '<option value="' + methodId4 + '">' + methodId4 + '</option>';
            //             // }
            //             $("#trmark").html(s);
            //         }
            //     })
            //
            // });
        }
    )
</script>
<script>
    // ************************ Drag and drop ***************** //
    let dropArea = document.getElementById('drop-area');

    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach((eventName) => {
        dropArea.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });

    // Highlight drop area when item is dragged over it
    ['dragenter', 'dragover'].forEach((eventName) => {
        dropArea.addEventListener(eventName, highlight, false);
    });
    ['dragleave', 'drop'].forEach((eventName) => {
        dropArea.addEventListener(eventName, unhighlight, false);
    });

    // Handle dropped files
    dropArea.addEventListener('drop', handleDrop, false);

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    function highlight(e) {
        dropArea.classList.add('highlight');
    }

    function unhighlight(e) {
        dropArea.classList.remove('active');
    }

    function handleDrop(e) {
        var dt = e.dataTransfer;
        var files = dt.files;

        handleFiles(files);
    }

    let uploadProgress = [];
    let progressBar = document.getElementById('progress-bar');

    function initializeProgress(numFiles) {
        progressBar.value = 0;
        uploadProgress = [];

        for (let i = numFiles; i > 0; i--) {
            uploadProgress.push(0);
        }
    }

    function updateProgress(fileNumber, percent) {
        uploadProgress[fileNumber] = percent;
        let total =
            uploadProgress.reduce((tot, curr) => tot + curr, 0) /
            uploadProgress.length;
        console.debug('update', fileNumber, percent, total);
        progressBar.value = total;
    }

    function handleFiles(files) {
        files = [...files];
        initializeProgress(files.length);
        files.forEach(uploadFile);
        files.forEach(previewFile);
    }

    function previewFile(file) {
        let reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onloadend = function () {
            let img = document.createElement('img');
            img.src = reader.result;
            document.getElementById('gallery').appendChild(img);
        };
    }

    function uploadFile(file, i) {
        var url = 'https://api.cloudinary.com/v1_1/joezimim007/image/upload';
        var xhr = new XMLHttpRequest();
        var formData = new FormData();
        xhr.open('POST', url, true);
        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');

        // Update progress (can be used to show progress indicator)
        xhr.upload.addEventListener('progress', function (e) {
            updateProgress(i, (e.loaded * 100.0) / e.total || 100);
        });

        xhr.addEventListener('readystatechange', function (e) {
            if (xhr.readyState == 4 && xhr.status == 200) {
                updateProgress(i, 100); // <- Add this
            } else if (xhr.readyState == 4 && xhr.status != 200) {
                // Error. Inform the user
            }
        });

        formData.append('upload_preset', 'ujpu6gyk');
        formData.append('file', file);
        xhr.send(formData);
    }
</script>
</body>
</html>
