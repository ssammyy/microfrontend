<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Mar 18 2020 20:03:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e7130c996c4ca37928b351f" data-wf-site="5e70fb3a565ebd99c1db37ce"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>KEBS</title>
    <th:block th:include="fragments/general-form.html :: headerfiles"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/accordion.css}"/>
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <style>
        * { font: 17px Calibri; }
        table { width: 70%; }
        table, th, td { border: solid 1px #DDD;
            border-collapse: collapse; padding: 2px 3px; text-align: center;
        }
    </style>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background-color: #f1f1f1;
        }

        #regForm {
            background-color: #ffffff;
            margin: 20px auto;
            font-family: Raleway;
            padding: 5px;
            width: 70%;
            min-width: 300px;
        }

        h1 {
            text-align: center;
        }

        input {
            padding: 10px;
            width: 100%;
            font-size: 17px;
            font-family: Raleway;
            border: 1px solid #aaaaaa;
        }

        /* Mark input boxes that gets an error on validation: */
        input.invalid {
            background-color: #ffdddd;
        }

        /* Hide all steps.css by default: */
        .tab {
            display: none;
        }

        button {
            background-color: #0082f3;
            color: #ffffff;
            border: none;
            padding: 10px 20px;
            font-size: 17px;
            font-family: Raleway;
            cursor: pointer;
        }

        button:hover {
            opacity: 0.8;
        }

        #prevBtn {
            background-color: #bbbbbb;
        }

        /* Make circles that indicate the steps.css of the form: */
        .step {
            height: 15px;
            width: 15px;
            margin: 0 2px;
            background-color: #bbbbbb;
            border: none;
            border-radius: 50%;
            display: inline-block;
            opacity: 0.5;
        }

        .step.active {
            opacity: 1;
        }

        /* Mark the steps.css that are finished and valid: */
        .step.finish {
            background-color: #4CAF50;
        }
    </style>
</head>
<body onload="createTable()">
<div class="top-bar" th:replace="fragments/general-form.html :: top-bar"></div>

<div class="section">
    <div class="w-layout-grid main-grid">
        <div class="main-grid-side-navigation" id="w-node-d308c123a20f-c123a20d"
             th:replace="fragments/general-form.html :: side-navigation-bar"></div>
        <div id="w-node-27962c2db181-c676b3e3" class="main-content-div">
            <div class="content-nav" th:replace="fragments/general-form.html :: content-navigation-bar"></div>
            <div class="content-wrap">
                <div class="content-row">
<!--                    <div class="pvocformblock w-form">-->
                        <form id="regForm" th:object="${investInspectReport}" th:action="@{/api/ms/sample-submitted/save(workPlanID=${workPlanId})}" method="post">
                            <h5>Sample Submission:</h5>
                            <div>
<!--                                <input id="itemId" name="itemId" th:value="${session.item?.id}" type="hidden">-->
<!--                                <input id="createdBy" name="createdBy" th:value="${session.currentUser.firstName}+ ' ' +${session.currentUser.lastName}" type="hidden">-->
                                <label for="nameProduct" class="field-label">Report reference</label>
<!--                                <input type="hidden" id="nameProduct"  name="nameProduct" th:value="${session.item?.itemDescription}">-->
                                <input type="text" class="w-input" maxlength="256"  name="nameProduct" data-name="nameProduct" id="nameProduct" th:field="*{reportReference}">

                            </div>
                            <div>
                                <label for="packaging" class="field-label">To</label>
<!--                                <input id="packaging" name="packaging" th:value="${session.item?.packageType}"-->
<!--                                       type="hidden">-->
                                <input type="text" class="w-input" maxlength="256" name="packaging" data-name="packaging" id="packaging" th:field="*{reportTo}">
                            </div>
                            <div>
                                <label for="labellingIdentification" class="field-label">Through</label>
                                <input type="text" class="w-input" maxlength="256" name="labellingIdentification" data-name="labellingIdentification" id="labellingIdentification"   th:field="*{reportThrough}">


                             <div>
                                <label for="labellingIdentification" class="field-label">From</label>
                                <input type="text" class="w-input" maxlength="256" name="labellingIdentification" data-name="labellingIdentification" id="labellingIdentification"   th:field="*{reportFrom}">

                            </div>
                            <div>
                                <label for="sizeTestSample" class="field-label"> Subject</label>
                                <input type="text"  class="w-input" maxlength="256" name="sizeTestSample" data-name="sizeTestSample" id="sizeTestSample"   th:field="*{reportSubject}">
                                <label for="sizeRefSample" class="field-label">Title</label>
                                <input type="text"  class="w-input" maxlength="256" name="sizeRefSample" data-name="sizeRefSample" id="sizeRefSample"   th:field="*{reportTitle}">
                                <label for="fileRefNumber" class="field-label">Date</label>
                                <input type="date"  class="w-input" maxlength="256" name="fileRefNumber" data-name="fileRefNumber" id="fileRefNumber"   th:field="*{reportDate}">
                            </div>
                            <div>
                                <label for="referencesStandards" class="field-label">Region</label>
                                <input type="text" class="w-input" maxlength="256" name="referencesStandards" data-name="referencesStandards" id="referencesStandards"   th:field="*{reportRegion}">

                            </div>
                            <div>
                                <label for="referenceStandards" class="field-label">Department</label>
                                <input type="text" class="w-input" maxlength="256" name="referenceStandards" data-name="reference Standards" id="referenceStandards"   th:field="*{reportDepartment}">

                            </div>
                            <div>
                                <label for="sendersName" class="field-label">Function</label>
<!--                                <input type="hidden" id="submittingOfficer" name="submittingOfficer" th:field="${session.currentUser.firstName}+ ' ' +${session.currentUser.lastName}">-->
                                <input type="text"  class="w-input" maxlength="256" name="sendersName" data-name="sendersName" id="sendersName" th:field="*{reportFunction}">
                                <label for="designation" class="field-label">Background Information</label>
<!--                                <input type="hidden" id="officerDesignation" name="officerDesignation" th:field="${session.designation.designationName}">-->
                                <textarea   class="w-input" maxlength="256" name="designation" data-name="designation" id="designation" th:field="*{backgroundInformation}"></textarea>
                                <label for="address" class="field-label">Objective of the Investigation</label>
                                <!--                                <input type="hidden" id="officerDesignation" name="officerDesignation" th:field="${session.designation.designationName}">-->
                                <textarea type="text"  class="w-input" maxlength="256" name="address" data-name="address" id="address" th:field="*{objectiveInvestigation}"></textarea>
                                <label for="sendersDate" class="field-label">Date of Investigation/Inspection</label>
                                <input type="date" class="w-input" maxlength="256" name="sendersDate" data-name="sendersDate" id="sendersDate"   th:field="*{dateInvestigationInspection}">
<!--                                <label for="sta30SlNo" class="field-label">STA/30 SL No</label>-->
<!--                                <input type="text" class="w-input" maxlength="256" name="sta30SlNo" data-name="sta 30 Sl No" id="sta30SlNo"   th:field="*{sta30SlNo}">-->
                            </div>
                            <div>
                                <label for="receiversName" class="field-label">KEBS Inspectors</label>
                                <!--                                <input type="hidden" id="submittingOfficer" name="submittingOfficer" th:field="${session.currentUser.firstName}+ ' ' +${session.currentUser.lastName}">-->
                                <textarea type="text"  class="w-input" maxlength="256" name="receiversName" data-name="receiversName" id="receiversName" th:field="*{kebsInspectors}"></textarea>
<!--                                <label for="officerDesignation" class="field-label">Designation</label>-->
<!--                                &lt;!&ndash;                                <input type="hidden" id="officerDesignation" name="officerDesignation" th:field="${session.designation.designationName}">&ndash;&gt;-->
<!--                                <input type="text" disabled class="w-input" maxlength="256" name="packageType" data-name="package Type" id="officerDesignation2" th:field="${session.designation.designationName}">-->
<!--                                <label for="officerDesignation" class="field-label">Address</label>-->
<!--                                &lt;!&ndash;                                <input type="hidden" id="officerDesignation" name="officerDesignation" th:field="${session.designation.designationName}">&ndash;&gt;-->
<!--                                <input type="text" disabled class="w-input" maxlength="256" name="packageType" data-name="package Type" id="officerDesignation2" th:field="${session.designation.designationName}">-->
<!--                                <label for="sta30SlNo" class="field-label">Date</label>-->
<!--                                <input type="date" class="w-input" maxlength="256" name="sta30SlNo" data-name="sta 30 Sl No" id="sta30SlNo"   th:field="*{sta30SlNo}">-->
                                <!--                                <label for="sta30SlNo" class="field-label">STA/30 SL No</label>-->
                                <!--                                <input type="text" class="w-input" maxlength="256" name="sta30SlNo" data-name="sta 30 Sl No" id="sta30SlNo"   th:field="*{sta30SlNo}">-->
                            </div>

<!--                            <input type="button" id="more_fields" onclick="add_fields();" field="Add More" />-->

                            <div>
                                <label for="sampleReferences" class="field-label">Methodology Employed</label>
                                <textarea type="text" class="w-input" maxlength="256" name="sampleReferences" data-name="sampleReferences" id="sampleReferences"   th:field="*{methodologyEmployed}">
                            </div>
                            <div>
                                <!--                                <label for="testRequest" class="field-label">12. Test Request</label>-->
                                <!--                                <input type="text" class="w-input" maxlength="256" name="testCharges" data-name="test Request" id="testRequest"   th:field="*{testRequest}">-->
                                <label class="field-label" for="testChargesKsh">Conclusion</label>
                                <textarea type="text" class="w-input" maxlength="256" name="testChargesKsh" data-name="testChargesKsh" id="testChargesKsh" th:field="*{conclusion}"></textarea>
                                <label for="receiptLpoNumber" class="field-label">Recommendations</label>
                                <textarea type="text" class="w-input" maxlength="256" name="receiptLpoNumber" data-name="receiptLpoNumber" id="receiptLpoNumber"   th:field="*{recommendations}"></textarea>
                                <label for="invoiceNumber" class="field-label">Status of activity</label>
                                <textarea type="text" class="w-input" maxlength="256" name="invoiceNumber" data-name="invoiceNumber" id="invoiceNumber"   th:field="*{statusActivity}"></textarea>


                            </div>
<!--                            <div>-->
<!--                                <label for="disposal" class="field-label">Disposal</label>-->
<!--                                <input type="text" class="w-input" maxlength="256" name="disposal" data-name="disposal" id="disposal"   th:field="*{disposal}">-->
<!--                            </div>-->

                            <div>
                                <label for="remarks" class="field-label">Final remark</label>
                                <textarea class="w-input" maxlength="256" name="remarks" data-name="remarks" id="remarks"   th:field="*{finalRemarkHod}"></textarea>

                            </div>

                            <div class="field-container">
                                <button class="button bg-yellow w-button">Back</button>
                                <button type="submit" class="button w-button" style="float: right;">Submit</button>
                            </div>
                            <!--                        <div style="float:right;">-->
                            <!--                            <button type="button" id="nextBtn" onclick="nextPrev(1)">Submit</button>-->
                            <!--                        </div>-->
                        </form>
<!--                    </div>-->
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="../assets/js/webflow.js" type="text/javascript"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<!-- [if lte IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
<script>
    var i = 1;

    function add_Labs() {
        var par = document.getElementById("Par" + i + "");
        par.style.display = "block";  // <-- Set it to block
        var lab = document.getElementById("lab" + i + "");
        lab.style.display = "block";
        i++;
    }

    function remove_Labs(elementId) {
        document.getElementById("Par" + elementId + "").remove();
        document.getElementById("lab" + elementId + "").remove();
    }


</script>
<script>
    $(document).ready(function () {
        $("#nonComplianceStatus_no").click(function () {
            if ($(this).is(':checked')) {
                $("#nonCompliance_rm").css("display", "block")
            } else {
                $("#nonCompliance_rm").css("display", "none")
            }
        });
        $("#nonComplianceStatus_yes").click(function () {
            if ($(this).is(':checked')) {
                $("#nonCompliance_rm").css("display","none")
            }
        });

    });
</script>
<script>
    var remarkType = '';
    $(document).ready(function(){

        $('.pvocformblock .addNewParameterBtn').on('click',function (event) {

            const empTab = document.getElementById('empTable');

            const rowCnt = empTab.rows.length;   // table row count.
            let tr = empTab.insertRow(rowCnt); // the table row.
            tr = empTab.insertRow(rowCnt);

            for (let c = 0; c < arrHead.length; c++) {
                let td = document.createElement('td'); // table definition.
                td = tr.insertCell(c);

                if (c == 0) {      // the first column.
                    // add a button in every new row in the first column.
                    const button = document.createElement('input');

                    // set input attributes.
                    button.setAttribute('type', 'button');
                    button.setAttribute('value', 'Remove');

                    // add button's 'onclick' event.
                    button.setAttribute('onclick', 'removeRow(this)');
                    // button.style.backgroundColor('#0082f3')

                    td.appendChild(button);
                }else if(c == 1){
                    // add a button in every new row in the first column.
                    const labDropDown = document.createElement('select');
                    $.ajax({
                        method: "GET",
                        url: `/api/di/populate-all-labs`,
                        success(response){
                            console.log(response);
                            let s = '';
                            var opt;
                            for (let i = 0; i < response.length; i++) {
                                const option = document.createElement("option");
                                option.setAttribute("value", i);
                                option.text = response[i].labName;
                                labDropDown.appendChild(option);
                            }

                        }
                    });

                    td.appendChild(labDropDown);
                } else {
                    //  3rd and 4th column, will have textbox.
                    const ele = document.createElement('input');
                    ele.setAttribute('type', 'text');
                    ele.setAttribute('value', '');

                    td.appendChild(ele);
                }
            }
            // $('.blackListForm #blackListModal').modal();
        });

        $('.pvocformblock .saveParameterBtn').on('click',function (event) {
            // function submit_fields() {
                var obj = {},
                    valid = true;
                var i;
                for (i = 0; i < room; i++) {
                    if(document.getElementById('divId'+i+'')) {
                        labDetails = '#labs' + i;
                        parmDetails = '#parameter' + i;
                        var objDetails = {
                            key1: $("" + labDetails + "").children("option:selected").val(),
                            key2: $('' + parmDetails + '').val()
                        };
                        // obj["labs"+i+""] =  $(""+labDetails+"").children("option:selected").val()
                        list.push(objDetails);
                    }
                }
                console.log(list)
                // $ins.each(function() {
                //     var val = this.value.trim();
                //     if (val) {
                //         obj[this.id] = val;
                //     } else {
                //         var name = this.previousSibling.nodeValue.trim();
                //         alert(name.substring(0, name.length - 1) + ' cannot be blank');
                //         this.focus();
                //         valid = false;
                //         return false;
                //     }
                // });
                // if (valid) {
                //     list.push(obj);
                //     $ins.val('');
                //
                //     $.each(obj, function(key, value) {
                //         var count = counter[key][value] || 0;
                //         counter[key][value] = count + 1;
                //     });
                //
                // }
            // }
        });


    });

</script>
<script>
    let arrHead = [];  // array for header.
    arrHead = ['', 'Laboratory Name', 'Parameters'];

    // first create TABLE structure with the headers.
    function createTable() {
        const empTable = document.createElement('table');
        empTable.setAttribute('id', 'empTable'); // table id.

        const tr = empTable.insertRow(-1);
        for (let h = 0; h < arrHead.length; h++) {
            const th = document.createElement('th'); // create table headers
            th.innerHTML = arrHead[h];
            tr.appendChild(th);
        }

        const div = document.getElementById('cont');
        div.appendChild(empTable);  // add the TABLE to the container.
    }


    // delete TABLE row function.
    function removeRow(oButton) {
        const empTab = document.getElementById('empTable');
        empTab.deleteRow(oButton.parentNode.parentNode.rowIndex); // button -> td -> tr.
    }

    // function to extract and submit table data.
    function submit() {
        const myTab = document.getElementById('empTable');
        const arrValues = [];

        // loop through each row of the table.
        for (let row = 1; row < myTab.rows.length - 1; row++) {
            // loop through each cell in a row.
            var objDetails;
            for (let c = 0; c < myTab.rows[row].cells.length; c++) {
                const element = myTab.rows.item(row).cells[c];
                if (element.childNodes[0].getAttribute('type') == 'option') {
                    objDetails = {key1: "'" + element.childNodes[0].value + "'", key2: "'" + element.childNodes[0].value + "'"};
                    arrValues.push("'" + element.childNodes[0].value + "'");
                }
                if (element.childNodes[0].getAttribute('type') == 'text') {
                    arrValues.push("'" + element.childNodes[0].value + "'");
                }
            }
        }

        // The final output.
        document.getElementById('output').innerHTML = arrValues;
        //console.log (arrValues);   // you can see the array values in your browsers console window. Thanks :-)
    }
</script>
<script>
    var room = 6;
    var listNumber = 4;
    var labId;
    var divID;
    function add_fields() {
        room++;
        listNumber++;
        divID = 'divId' + room;
        var objTo = document.getElementById('room_fileds');
        var divtest = document.createElement("div");

        divtest.innerHTML = '<div id="divId' + room + '" class="label">Parameters to be tested ' + room + ':  <input type="button" id="' + room + '" onclick="removeElement(this.id);" value="Remove" /></div>' +
            '<div id="divValue' + room + '" class="content">' +
            '<span>Laboratory Name: ' +
            '<select id="labs' + room + '"  class="select-field w-select" th:field="*{featureArrayList[' + listNumber + '].laboratoryId}"> ' +
            '</select>' +
            '</small>  </span><span>Parameter: <input type="text" style="width:150px;" id="parameter' + room + '" name="length[]" th:field="*{featureArrayList[' + listNumber + '].parameters}" />' +
            '<small></small></span>' +
            '</div>';

        objTo.appendChild(divtest);

        labId = '#labs' + room;
        $.ajax({
            method: "GET",
            url: `/api/di/populate-all-labs`,
            success(response) {
                console.log(response);
                let s = '';
                for (let i = 0; i < response.length; i++) {
                    s += '<option value="' + response[i].id + '">' + response[i].labName + '</option>';
                }
                $("" + labId + "").html(s);
            }
        })

    }

    function removeElement(elementId) {
        document.getElementById('divValue'+elementId+'').remove();
        document.getElementById('divId'+elementId+'').remove();
    }

    var list = [];
    var labDetails;
    var parmDetails;

    function submit_fields() {
        var obj = {},
            valid = true;
        var i;
        for (i = 0; i < room; i++) {
            if(document.getElementById('divId'+i+'')) {
                labDetails = '#labs' + i;
                parmDetails = '#parameter' + i;
                var objDetails = {
                    key1: $("" + labDetails + "").children("option:selected").val(),
                    key2: $('' + parmDetails + '').val()
                };
                // obj["labs"+i+""] =  $(""+labDetails+"").children("option:selected").val()
                list.push(objDetails);
            }
        }
        console.log(list)
        // $ins.each(function() {
        //     var val = this.value.trim();
        //     if (val) {
        //         obj[this.id] = val;
        //     } else {
        //         var name = this.previousSibling.nodeValue.trim();
        //         alert(name.substring(0, name.length - 1) + ' cannot be blank');
        //         this.focus();
        //         valid = false;
        //         return false;
        //     }
        // });
        // if (valid) {
        //     list.push(obj);
        //     $ins.val('');
        //
        //     $.each(obj, function(key, value) {
        //         var count = counter[key][value] || 0;
        //         counter[key][value] = count + 1;
        //     });
        //
        // }
    }

</script>
</body>
</html>


