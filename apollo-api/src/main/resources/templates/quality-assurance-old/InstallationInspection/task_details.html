<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Wed Mar 18 2020 20:03:10 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e7111dc08e6f973c676b3e3" data-wf-site="5e70fb3a565ebd99c1db37ce"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title th:text="'KIMS - ' + ${title}"></title>
    <th:block th:include="fragments/general-form.html :: headerfiles"/>
    <link rel="stylesheet" th:href="@{/css/accordion.css}"/>
    <link rel="stylesheet" th:href="@{/assets/bootstrap3/css/bootstrap.css}"/>
</head>
<body>
<div class="top-bar" th:replace="fragments/general-form.html :: top-bar"></div>

<div class="section">
    <div class="w-layout-grid main-grid">
        <div class="main-grid-side-navigation" id="w-node-d308c123a20f-c123a20d"
             th:replace="fragments/general-form.html :: side-navigation-bar"></div>
        <div id="w-node-27962c2db181-c676b3e3" class="main-content-div">
            <div class="content-nav" th:replace="fragments/general-form.html :: content-navigation-bar"></div>
            <div class="content-wrap">
                <div class="content-container">
                    <div class="content-block">
                        <div class="content-block-parent">
                            <div class="content-block-child---top">
                                <div class="applicant-details" style="width: 550px">
                                    <div th:replace="fragments/general-form.html :: alerts-bar"></div>
                                    <button class="accordion" style="flex: 0 50%">Petrol Station Data</button>
                                    <div class="panel">
                                        <ul class="w-list-unstyled" style="width: 550px">
                                            <li class="list-item">
                                                <div class="list-title" style="color: #0166B1;">Station Name</div>
                                                <div class="list-text" th:text="${iiData?.stationName}"></div>
                                            </li>
                                            <br>
                                            <li class="list-item" style="border: black">
                                                <div class="list-title" style="color: #0166B1;">Location</div>
                                                <div class="list-text" th:text="${iiData?.location}"></div>
                                            </li>
                                            <br>
                                            <li class="list-item">
                                                <div class="list-title" style="color: #0166B1;">Contact Email</div>
                                                <div class="list-text" th:text="${iiData?.contactEmail}"></div>
                                            </li>
                                            <br>

                                        </ul>
                                    </div>

                                    <div th:if="${fieldInspectionData != null}">
                                        <button class="accordion" style="flex: 0 50%">Inspection Data</button>
                                        <div class="panel">
                                            <ul class="w-list-unstyled" style="width: 550px">
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Introduction</div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData?.introduction}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item" style="border: black">
                                                    <div class="list-title" style="color: #0166B1;">Construction
                                                        Details
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData?.constructionDetails}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Product Storage
                                                        Details
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.productStorageDetails}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Pipe Works and
                                                        Vents
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.pipeWorksAndVents}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Pumps and
                                                        Dispensers
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.pumpsAndDispensers}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Location and
                                                        Cabling
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.locationAndCabling}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Emergency Measures
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.emergencyMeasures}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Training Details
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.training}"></div>
                                                </li>
                                                <br>
                                                <li class="list-item">
                                                    <div class="list-title" style="color: #0166B1;">Officer's
                                                        Recommendations
                                                    </div>
                                                    <div class="list-text"
                                                         th:text="${fieldInspectionData.recommendation}"></div>
                                                </li>
                                                <br>

                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                            </div>

                        </div>
                        <div class="filter-block">
                            <div class="filter-block-title">
                                <div class="filter-title">Actions</div>
                            </div>
                            <div>
                                <div th:if="${iiData.assignedOfficer == null}"
                                     sec:authorize="hasAuthority('PETROLEUM_ALLOCATE_INSPECTION_OFFICER')">
                                    <!--                                        manager petroleum select officer-->
                                    <button style="width: 270px" type="button" class="btn btn-primary"
                                            data-toggle="modal" data-target="#assignOfficerHome">Assign Officer
                                    </button>
                                </div>

                                <a th:if="${iiData?.directorsApproval == null}"
                                   th:href="@{/ii(whereTo='director_review', id=${iiData.id}, inspectionReportApprovalStatus=1)}"
                                   sec:authorize="hasAuthority('RECEIVE_EPRA_NOTIFICATION_LETTER')"
                                   class="btn btn-primary" style="width: 270px">Approve the inspection</a>

                                <div th:if="${iiData.schedulestatus != 1} and ${iiData.scheduledDate == null} and ${iiData.assignedOfficer != null} and
                                            ${iiData.invoiceStatus == 1} and ${iiData.invoicePaymentStatus == 1}"
                                     sec:authorize="hasAuthority('SCHEDULE_FACTORY_VISIT')">
                                    <!--Officer: (QAO) generate profoma invoice and its sent to customer
                                        once paid, customer receives schedule after payment confirmation
                                    -->
                                    <button style="width: 270px" type="button" class="btn btn-primary"
                                            data-toggle="modal" data-target="#schedulaModal">Schedule Visit
                                    </button>
                                </div>

                                <div th:if="${iiData?.assignedOfficer != null} and ${iiData.invoiceStatus != 1}
                                        and ${iiData.scheduledDate == null} and ${iiData.schedulestatus != 1}
                                                " sec:authorize="hasAuthority('SCHEDULE_FACTORY_VISIT')">
                                    <!--                                    Generate profoma invoice-->
                                    <button style="width: 270px" type="button" class="btn btn-primary"
                                            data-toggle="modal" data-target="#proformaInvoice">Generate Proforma Invoice
                                    </button>
                                </div>
                                <br>
                                <div th:if="${iiData?.assignedOfficer != null} and ${iiData.invoiceStatus == 1}
                                        and ${iiData.scheduledDate == null} and ${iiData.schedulestatus != 1} and ${invoice}
                                                " sec:authorize="hasAuthority('SCHEDULE_FACTORY_VISIT')">
                                    <!--                                    Generate profoma invoice-->
                                    <a style="width: 270px" target="_blank"
                                       th:href="@{/generated/invoice/{id}(id=${invoice?.id},appId=199)}" type="button"
                                       class="btn btn-info">View Invoice</a>
                                </div>

                                <div th:if="${iiData?.assignedOfficer != null} and ${iiData.invoiceStatus == 1} and ${iiData.invoicePaymentStatus == 1}
                                        and ${iiData.scheduledDate != null} and ${iiData.schedulestatus == 1} and ${iiData.inspectionReportAvailability != 1}"
                                     sec:authorize="hasAuthority('SCHEDULE_FACTORY_VISIT')">
                                    <a style="width: 270px" class="btn btn-primary"
                                       th:href="@{/ii(id = ${iiData.id}, whereTo='conduct_inspection', isStage = 'started')}">Conduct
                                        Inspection</a>
                                </div>

                                <div th:if="${iiData.petroleumManagerReportApproval == 0} and ${iiData?.assignedOfficer != null} and ${iiData.invoiceStatus == 1} and
                                            ${iiData.invoicePaymentStatus == 1} and ${iiData?.scheduledDate != null} and ${iiData.schedulestatus == 1} and
                                                    ${iiData.inspectionReportAvailability ==1}">
                                    <a class="btn btn-info" style="width: 270px"
                                       th:href="@{/ii(id=${iiData.id, whereTo='resubmit_inspection_report_for_approval'})}">Resubmit
                                        report for approval</a>
                                </div>

                                <div th:if="${iiData?.assignedOfficer != null} and ${iiData.invoiceStatus == 1} and ${iiData.invoicePaymentStatus == 1}
                                        and ${iiData?.scheduledDate != null} and ${iiData.schedulestatus == 1} and ${iiData.inspectionReportAvailability ==1}"
                                     sec:authorize="hasAuthority('PETROLEUM_ALLOCATE_INSPECTION_OFFICER')">
                                    <h4>Approve/ Disapprove the Inspection report</h4>
                                    <a class="btn btn-primary"
                                       th:href="@{/ii(id = ${iiData.id}, whereTo='approve_inspection_report', inspectionReportApprovalStatus = 1)}"><i
                                            class="fa fa-check" aria-hidden="true"></i></a>
                                    <a class="btn btn-danger"
                                       th:href="@{/ii(id = ${iiData.id}, whereTo='approve_inspection_report', inspectionReportApprovalStatus = 0)}"><i
                                            class="fa fa-times" aria-hidden="true"></i></a>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="proformaInvoice" tabindex="-1" role="dialog"
                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="proformaInvoiceTitle">Generate Proforma Invoice</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <b>Confirm generation of proforma invoice.</b>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <a th:href="@{/ii(id = ${iiData.id}, whereTo='invoice')}" type="button"
                                   class="btn btn-primary">Confirm</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="schedulaModalHome">
                    <form id="assign-form" name="assign-form" th:action="@{/ii(id = ${iiData.id}, whereTo='schedule')}"
                          method="get">
                        <div class="modal fade" id="schedulaModal" tabindex="-1" role="dialog"
                             aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="schedulaModalLabel">Select a date</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <input type="hidden" value="schedule" name="whereTo">
                                            <input type="hidden" name="id" th:value="${iiData.id}">

                                            <label for="scheduleDate" class="col-form-label">Date of visit:</label>
                                            <input type="date" id="scheduleDate" class="input-field"
                                                   name="scheduleDate">
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
                                        </button>
                                        <input type="submit" class="btn btn-primary" value="save"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal fade" id="assignOfficerHome" tabindex="-1" role="dialog"
                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <form th:action="@{/ii(id = ${iiData.id}, whereTo='schedule')}" method="get">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Select an officer to assign.</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <input type="hidden" value="assign_officer" name="whereTo">
                                        <input type="hidden" name="id" id="id" th:value="${iiData.id}">
                                        <label for="officerToAssign" class="col-form-label">Date of visit:</label>
                                        <select class="form-control" id="officerToAssign" name="officerToAssign">
                                            <option>Select one..</option>
                                            <option th:text="${usr.userName}" th:value="${usr.id}"></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script th:src="@{/js/webflow.js}" type="text/javascript"></script>
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script th:src="@{/assets/bootstrap3/js/bootstrap.js}" type="text/javascript"></script>
<!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
<script>
    $(document).ready(function () {
        $('#scheduleId').on('click', function (event) {
            $('.myForm #exampleModal').modal();
        });
        $('#generateSchemeOfSupervisionId').on('click', function (event) {
            $('.scheme #schemeModal').modal();
        });
        $('#fillFactoryInspection').on('click', function (event) {
            $('.factoryInspectionForm #factoryInspectionFormModal').modal();
        });
    });

</script>
<script>
    // document.getElementById("firstDateId").onchange = function () {
    //     var input = document.getElementById("schedule");
    var input = document.getElementById("schedule");

    input.setAttribute("min", this.value);
    // }
</script>
<script>
    var acc = document.getElementsByClassName("accordion");
    // var btn = document.getElementsByClassName("button w-button eBtn");
    var i;

    for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function () {
            this.classList.toggle("active");
            this.style.border = "none";
            // this.style.position = "sticky"
            var panel = this.nextElementSibling;
            if (panel.style.maxHeight) {
                panel.style.maxHeight = null;
            } else {
                panel.style.maxHeight = panel.scrollHeight + "px";
                // panel.style.position = "-webkit-sticky"
                // panel.style.position = "sticky"
            }
        });
    }
</script>
<!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>




