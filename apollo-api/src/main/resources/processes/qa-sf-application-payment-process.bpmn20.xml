<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
    <process id="qaSfAppPaymentProcess" name="QA SF Application Payment Process" isExecutable="true">
        <startEvent id="qaSfapStart" name="Start"></startEvent>
        <userTask id="qaSfapSelectMark" name="Manufacturer Access Account and select mark"></userTask>
        <sequenceFlow id="flow1" sourceRef="qaSfapStart" targetRef="qaSfapSelectMark"></sequenceFlow>
        <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
        <sequenceFlow id="flow4" sourceRef="qaSfapCheckIfRenewal" targetRef="exclusivegateway1"></sequenceFlow>
        <userTask id="qaSfapFillAndSubmit" name="Fill &amp; Submit application"></userTask>
        <sequenceFlow id="flow6" sourceRef="exclusivegateway1" targetRef="qaSfapFillAndSubmit">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${renewal==0}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="qaSfapReviewApplication" name="Review and approve application">
            <extensionElements>
                <activiti:taskListener event="assignment" expression="${bpmnNotifications.sendEmail(task)}"></activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="flow7" sourceRef="qaSfapFillAndSubmit" targetRef="qaSfapReviewApplication"></sequenceFlow>
        <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
        <sequenceFlow id="flow8" sourceRef="qaSfapReviewApplication" targetRef="exclusivegateway2"></sequenceFlow>
        <serviceTask id="qaSfapComputePayment" name="Compute payment" activiti:expression="${bpmnCommonFunctions.computePayment(permitId)}"></serviceTask>
        <sequenceFlow id="flow10" sourceRef="exclusivegateway2" targetRef="qaSfapComputePayment">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${approvalStatus==1}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="qaSfapMakePayment" name="Make Payment">
            <extensionElements>
                <activiti:taskListener event="assignment" expression="${bpmnNotifications.sendEmail(task)}"></activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="flow13" sourceRef="qaSfapMakePayment" targetRef="qaSfapPaymentConfirmationNotif"></sequenceFlow>
        <endEvent id="qaSfapEnd" name="End"></endEvent>
        <sequenceFlow id="flow14" sourceRef="exclusivegateway2" targetRef="qaSfapEnd">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${approvalStatus==0}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="flow15" sourceRef="qaSfapPaymentConfirmationNotif" targetRef="qaSfapEnd"></sequenceFlow>
        <sequenceFlow id="flow16" sourceRef="qaSfapSelectMark" targetRef="qaSfapCheckIfRenewal"></sequenceFlow>
        <serviceTask id="qaSfapAutopopulateApplication" name="Autopopulate Application" activiti:expression="${bpmnCommonFunctions.autoPopulateApplication(permitId)}"></serviceTask>
        <sequenceFlow id="flow17" sourceRef="exclusivegateway1" targetRef="qaSfapAutopopulateApplication">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${renewal==1}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="flow18" sourceRef="qaSfapAutopopulateApplication" targetRef="qaSfapComputePayment"></sequenceFlow>
        <serviceTask id="qaSfapCheckIfRenewal" name="Check if Renewal" activiti:expression="${qualityAssuranceBpmn.qaSfApCheckIfRenewal(permitId)}"></serviceTask>
        <sequenceFlow id="flow19" sourceRef="qaSfapComputePayment" targetRef="qaSfapMakePayment"></sequenceFlow>
        <serviceTask id="qaSfapPaymentConfirmationNotif" name="Payment Confirmation Notification" activiti:expression="${bpmnNotifications.sendEmailServiceTask(email)}"></serviceTask>
    </process>
    <bpmndi:BPMNDiagram id="BPMNDiagram_qaSfAppPaymentProcess">
        <bpmndi:BPMNPlane bpmnElement="qaSfAppPaymentProcess" id="BPMNPlane_qaSfAppPaymentProcess">
            <bpmndi:BPMNShape bpmnElement="qaSfapStart" id="BPMNShape_qaSfapStart">
                <omgdc:Bounds height="35.0" width="35.0" x="160.0" y="140.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapSelectMark" id="BPMNShape_qaSfapSelectMark">
                <omgdc:Bounds height="71.0" width="121.0" x="310.0" y="122.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
                <omgdc:Bounds height="40.0" width="40.0" x="730.0" y="138.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapFillAndSubmit" id="BPMNShape_qaSfapFillAndSubmit">
                <omgdc:Bounds height="60.0" width="115.0" x="860.0" y="128.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapReviewApplication" id="BPMNShape_qaSfapReviewApplication">
                <omgdc:Bounds height="60.0" width="111.0" x="1050.0" y="128.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
                <omgdc:Bounds height="40.0" width="40.0" x="1220.0" y="138.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapComputePayment" id="BPMNShape_qaSfapComputePayment">
                <omgdc:Bounds height="55.0" width="105.0" x="698.0" y="350.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapMakePayment" id="BPMNShape_qaSfapMakePayment">
                <omgdc:Bounds height="55.0" width="105.0" x="865.0" y="460.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapEnd" id="BPMNShape_qaSfapEnd">
                <omgdc:Bounds height="35.0" width="35.0" x="1350.0" y="141.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapAutopopulateApplication" id="BPMNShape_qaSfapAutopopulateApplication">
                <omgdc:Bounds height="61.0" width="112.0" x="695.0" y="232.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapCheckIfRenewal" id="BPMNShape_qaSfapCheckIfRenewal">
                <omgdc:Bounds height="55.0" width="105.0" x="530.0" y="130.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape bpmnElement="qaSfapPaymentConfirmationNotif" id="BPMNShape_qaSfapPaymentConfirmationNotif">
                <omgdc:Bounds height="61.0" width="131.0" x="1067.0" y="457.0"></omgdc:Bounds>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
                <omgdi:waypoint x="195.0" y="157.0"></omgdi:waypoint>
                <omgdi:waypoint x="310.0" y="157.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
                <omgdi:waypoint x="635.0" y="157.0"></omgdi:waypoint>
                <omgdi:waypoint x="730.0" y="158.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
                <omgdi:waypoint x="770.0" y="158.0"></omgdi:waypoint>
                <omgdi:waypoint x="860.0" y="158.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
                <omgdi:waypoint x="975.0" y="158.0"></omgdi:waypoint>
                <omgdi:waypoint x="1050.0" y="158.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
                <omgdi:waypoint x="1161.0" y="158.0"></omgdi:waypoint>
                <omgdi:waypoint x="1220.0" y="158.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow10" id="BPMNEdge_flow10">
                <omgdi:waypoint x="1240.0" y="178.0"></omgdi:waypoint>
                <omgdi:waypoint x="1239.0" y="377.0"></omgdi:waypoint>
                <omgdi:waypoint x="803.0" y="377.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
                <omgdi:waypoint x="970.0" y="487.0"></omgdi:waypoint>
                <omgdi:waypoint x="1067.0" y="487.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow14" id="BPMNEdge_flow14">
                <omgdi:waypoint x="1260.0" y="158.0"></omgdi:waypoint>
                <omgdi:waypoint x="1350.0" y="158.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow15" id="BPMNEdge_flow15">
                <omgdi:waypoint x="1198.0" y="487.0"></omgdi:waypoint>
                <omgdi:waypoint x="1367.0" y="487.0"></omgdi:waypoint>
                <omgdi:waypoint x="1367.0" y="176.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
                <omgdi:waypoint x="431.0" y="157.0"></omgdi:waypoint>
                <omgdi:waypoint x="530.0" y="157.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
                <omgdi:waypoint x="750.0" y="178.0"></omgdi:waypoint>
                <omgdi:waypoint x="751.0" y="232.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow18" id="BPMNEdge_flow18">
                <omgdi:waypoint x="751.0" y="293.0"></omgdi:waypoint>
                <omgdi:waypoint x="750.0" y="350.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
                <omgdi:waypoint x="750.0" y="405.0"></omgdi:waypoint>
                <omgdi:waypoint x="750.0" y="487.0"></omgdi:waypoint>
                <omgdi:waypoint x="865.0" y="487.0"></omgdi:waypoint>
            </bpmndi:BPMNEdge>
        </bpmndi:BPMNPlane>
    </bpmndi:BPMNDiagram>
</definitions>